---
layout: post
title: Bug Hunting Journey of 2021
canonical_url: https://infosecwriteups.com/bug-hunting-journey-of-2021-1fa60b28d949?source=rss-738ac78f7fe8------2
---

<p>Heyy Everyoneeee,</p><p>I hope everyone had a good hacking year, I didn’t shared any writeups this year so I thought I should do one writeup where I will be discussing most of the bugs which I found this year mainly on the <em>Hackerone </em>platform. All bugs were find manually with the help of Burp, Browser and Brain</p><p>This will be similar blog like I already did before:</p><p><a href="https://sudhanshur705.medium.com/bug-hunting-journey-of-2019-95e5190aca7c">Bug Hunting Journey of 2019</a></p><p>This year I stopped using any scripts to find bugs and totally relied upon my manual hacking skills to find bugs. Instead of going after the subdomains I focused on directly going after the main application.</p><p>So you can say that instead of going wider I was going deeper into the target this year.</p><p>I had to make many changes in my approach as before I was just using scripts and doing hacking from the terminal, now I have to browse the target understand how it works, then try to break it.</p><p>I won’t lie I was using <em>Burpsuite cracked version</em> at that time, yup you heard it right the LarryLau one. The first thing I did was to dump the cracked version and just use the Community version.</p><p>I realized it now that I really didn’t needed it but I don’t know why I was using it since I started doing bug hunting maybe because whatever <em>video poc/ tutorial</em> I picked up from youtube, etc were also using the cracked version so it stuck in my mind that to be good at bug hunting you need <em>BurpSuite pro</em>.</p><p><strong><em>I decided to dump the cracked version because</em>:</strong></p><p>You might already knew about him:</p><p><a href="https://in.linkedin.com/in/rootxharsh">Harsh Jaiswal - Bug bounty participant - HackerOne | LinkedIn</a></p><p>Harsh is super good at finding server side bugs, if you have looked at his <em>video pocs</em> you might noticed that he uses the <em>Burp Community version</em>, this changed my mentality that you don’t need this Pro tools to find bugs you just need to build up the right skills &amp; experience to do it.</p><p>There was a tweet from s0md3v (I can’t find :( now), where he told someone that you shouldn’t use the cracked version. <em>Portswigger </em>does so much for the community, Labs (Web Security Academy), research papers, etc all for free so you shouldn’t betray them in this way. Use the Community version it has all the stuffs you need.</p><p>Along the way I got free access to these awesome sites for building up my skills:</p><p>Won this one from a CTF challenge which @zseano created :)</p><p><a href="https://www.bugbountyhunter.com/">Become a bug bounty hunter - Learn about web application vulnerabilities and how to find them on bug bounty programs | BugBountyHunter.com</a></p><p>Thanks to Snyff and Codingo for their generous giveaway.</p><p><a href="https://pentesterlab.com/">PentesterLab - Learn Web Penetration Testing: The Right Way</a></p><h4>On to the bugs now</h4><p>It was pretty hard at the beginning as I was dealing with many Informative reports as I was new to this. My reports didn’t demonstrated any impact so all of them were getting closed. But I kept submitting them</p><p>During that time I saw some disclosed reports from :</p><ul><li><a href="https://hackerone.com/logitech?type=team">Logitech - Bug Bounty Program | HackerOne</a></li><li><a href="https://hackerone.com/automattic">Automattic - Bug Bounty Program | HackerOne</a></li></ul><p>So I thought I should give it a try to see if the disclosed bugs are actually fixed or if I can bypass the protection in place.</p><p>I spend quite a time in streamlabs.com, it’s in scope for bounty under Logitech bbp:</p><p><a href="https://streamlabs.com/">Streamlabs | #1 free set of tools for live streamers and gamers</a></p><p>At first I was quite hesitant to hunt on them as <em>Streamlab </em>is very popular, but I still I tried</p><p>Found a <strong><em>stored xss</em></strong>, which was really easy to find :) , it was kind of self xss as this page can only be viewed from my dashboard. Later I found that we can invite other users to our dashboard so I added that in my report</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*SzCY6Dt1t3pUFjNPWG6tAA.png" /></figure><p><a href="https://hackerone.com/reports/1049012">Logitech disclosed on HackerOne: Stored XSS in...</a></p><p>And then I found a <strong><em>csrf vuln</em></strong> which affected most of the endpoints,</p><p>Although there was a <em>csrf header </em>in the request it wasn’t validated at all by the server so while testing the application I just removed this header and voila it still worked. But there was one problem, the <em>Content-Type</em> header was properly validated so it must be set to application/json so I couldn’t create a <em>csrf poc</em> as it will trigger a CORS preflight request.</p><p>So I went through all the endpoints and found one which accepted text/plain</p><p><a href="https://hackerone.com/reports/1049360">Logitech disclosed on HackerOne: CSRF in changing users...</a></p><p>To create a CSRF poc for JSON request, we need to add an extra padding. In the below screenshot you can see that I have added an extra <em>key,value</em> pair (highlighted part) which will make sure the <em>request body</em> is valid json data</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*JeQ7ZhVIpnPDZipf1yWJcQ.png" /></figure><p>Read this writeup from Geekboy if you want to know more about this JSON CSRF POC:</p><p><a href="https://www.geekboy.ninja/blog/tag/json-csrf/">Geekboy | Security Researcher</a></p><p>During this time I found one last bug in Logitech , <strong>Streamlab </strong>offers many features which are available to <em>Prime members</em> only.</p><p>All the highlighted endpoints requires <em>Prime subscription</em>.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*2SGeOZk2nh88K3cTHc1ZJg.png" /></figure><p>While going through different request/response’s , I found this endpoint quite interesting:</p><pre><a href="https://streamlabs.com/api/v5/user/prime/subscription">https://streamlabs.com/api/v5/user/prime/subscription</a></pre><pre><strong>Reponse</strong>:</pre><pre>{<br>  &quot;is_active&quot;: false,<br>  &quot;is_pending&quot;: false,<br>  &quot;is_past_due&quot;: false,<br>  &quot;is_canceled&quot;: false,<br>  &quot;is_pro&quot;: false,<br>  &quot;type&quot;: &quot;&quot;,<br>  &quot;free_trial_claimed&quot;: false,<br>  &quot;hibernate_claimed&quot;: false,<br>  &quot;free_trial_eligible&quot;: false,<br>  &quot;hibernate_eligible&quot;: false,<br>  &quot;cooldown_eligible&quot;: false,<br>  &quot;cooldown_seconds_past&quot;: null<br>}</pre><p>Everything is set to false, so I decided to use the <em>Burp’s Match and Replace</em> rule to replace every occurrence of false in the Response body to true</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/923/1*X9xCcr0prbgxPP6_F1n_-g.png" /><figcaption>Burp Match &amp; Replace</figcaption></figure><pre><strong>Type</strong>: Response Body <br><strong>Match</strong>: false <br><strong>Replace</strong>: true</pre><p>I was just curious to see if the application was actually relying upon <em>client side validation</em> only to check whether the user has Prime subscription or not.</p><p>To my surprise, it actually worked.</p><p>The most interesting part of the <em>Prime subscription</em> is that you get free stuffs like tshirt, mouse,etc</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*dN0gIeo13iZ_zAiYRhWiJQ.png" /><figcaption>Before applying the Match &amp; Replace rule</figcaption></figure><p>Now look at this screenshot after applying the Match &amp; Replace rule:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*my-_3GZ7px1_EO9bku-Pww.png" /></figure><p>To actually confirm it worked or not, I clicked on the <strong><em>Reedeem </em></strong>button and it asked for an email address:</p><p>This is the exact email I received in my inbox:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*2GDeze0aJpiDlPkc21xG8g.png" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*-wOdnpfbiS-1_o0hyiwAkA.png" /></figure><p>A coupon code to purchase the Logitech Mouse for free</p><p><em>I told them this impact:</em></p><p><em>By creating 1000 accounts I can claim 1000 gifts , the gift is a logitech gaming mice which cost on average is around $30. So 1000 Logitech gaming mouse costs would be 30*1000 = $30,000 . I can get all of this for free</em></p><p>It could lead to financial loss to the company but they still lowered the severity :(</p><p><a href="https://hackerone.com/reports/1070510">Logitech disclosed on HackerOne: Manipulating response leads to...</a></p><p>I participated in h1-ctf which was going on during the last week of the year, so I was able to get many free invites private programs. I decided to focus on the private programs more as I would have better chance of finding an valid bug there.</p><p>As most of the bugs I found were in Private programs , most of the things will be in <strong>redacted </strong>form.</p><h4>BUG: XSS leads to Account Takeover</h4><p>I started with a program which started just few months back , it was completely new there weren’t many submissions and the response time was really appealing so I decided to give it a shot.</p><p>After poking around here and there in the site for a while I had now idea about the application working what all features it provides. The application was basically something similar to <strong><em>TryHackme </em></strong>platform.</p><p>I looked at the cookie policies:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*kCr5U-OORn3D7P6V0O9jCw.png" /></figure><p>You can see the scope of the cookie is set to .example.com</p><p>which means that all the subdomains will also have the same cookie as example.com so if I am able to find xss on a subdomain it will allow me to easily steal the victim’s cookies. The interesting part about this application was that all the vulnerable challenges were hosted on the subdomain of example.com</p><p>eg. Suppose there was a xss challenge, so it will be hosted on a subdomain xss-challenge.example.com</p><p>So I used the xss-challenge.example.com subdomain (which already had a xss vuln ) to demonstrate that it’s possible to steal other user’s session cookies via the xss. I told them to change the scope of the cookies to a single domain only or else use some sandbox domains for hosting the challenges.</p><p>This issue was triaged and rewarded as a HIGH severity vuln :)</p><h4><strong><em>Moving on to the next program,………..</em></strong></h4><p>This program was 2–3 years old and had a large amount of submission rate, the hacker on 1st place had a reputation of <em>1500+</em></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/377/1*sxAnEbNMuxU7J6uNx79SZg.png" /></figure><p>Looking at the statistics of the program you can confidentially say that the chances of getting a duplicate for a bug are very high as they are taking on average <em>1 year to fix</em> an issue, I still decided to give this program a try.</p><h4>BUG: Multiple CSRF</h4><p>Found a <strong><em>csrf bug</em></strong> which allowed me to change the victim’s login email address this could easily lead to account takeover vulnerability I quickly reported it and as expected it was duplicate.</p><p>Then I found many more <em>csrf </em>bugs like <em>changing applicant’s name</em> and many other low severity <em>csrf</em> vulns. I decided not to report them as they might have been already reported (<em>as I already go a duplicate for a high severity csrf vuln</em> ) and didn’t wanted to waste my time on them.</p><p>After few days when I didn’t find any other bugs on the same target, I thought fuck it man I will report those low severity <em>csrf </em>bugs and see what happens.</p><p>Reported them during the evening and the next morning when I checked my mails there was some activity in those reports, I was like yeah all of them got closed as duplicate I already know but when I opened the mail I found that all of them were triaged and rewarded which I didn’t expected at all.</p><p>I had already reported 4–5 of those csrf bugs, so I decided to find more similar ones .It was very easy to identify those vulnerable requests as there was no csrf token in them</p><p>In total I was able to find around 10 csrf bugs non-duplicate all got rewarded. I was quite motivated then to hunt on the program more.</p><h4>BUG: IDOR</h4><p>I then checked other domains mentioned in the scope , in one application I could see there was parameter company_id in most of the <strong><em>GET</em></strong> Based request only. So I tested them for <em>IDOR </em>vuln, soon enough found one which was disclosing some information related to the victim’s company, I reported this IDOR and it was closed as Duplicate :(</p><p>Earlier I specifically mentioned that only <em>GET Based request</em> were having that comapny_id parameter, there was no such parameter in case of <strong><em>POST </em></strong>based requests (like changing profile settings, company settings)</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*8KXlDsSaiMVlKP5he7287g.png" /></figure><p>Although the <em>GET Based IDOR</em> report got duplicate, this one didn’t. It was triaged and rewarded as High Severity.</p><p>If you are looking for a collection of IDOR bypasses checkout this site:</p><p><a href="https://book.hacktricks.xyz/pentesting-web/idor">IDOR</a></p><h4>BUG: Stored XSS via SVG File upload along with 2 bypasses</h4><p>Now I am going to tell you about an experience on a program where I felt I was cheated, yup this happens a lot not all programs are good so make sure you choose the right one :)</p><p>I found a stored xss bug in this program via file attachments upload , it was basically a Slack type application.</p><p>The uploaded files were stored in a s3 bucket eg: xmessenger-attachments.s3.amazonaws.com ,</p><p>The same uploaded files could also be accessed from a subdomain of the target attachments.example.com</p><p>I uploaded a svg file with the following contents:</p><iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/209271b93b7d0bfeb04878cd14af006c/href">https://medium.com/media/209271b93b7d0bfeb04878cd14af006c/href</a></iframe><p>The url of the uploaded file was something like this:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/848/1*KDMlJgthzHZxvhgEKGGdQQ.png" /></figure><p>I have a xss on a subdomain of the target, if you’re not short tempered I told something about this in the beginning of the article :)</p><p>I checked the <em>cookie scope policy</em> and found the same thing here also .example.com , this time in the cookies there was a <em>jwt token</em> which was used in all the api endpoints and other subdomains for authentication purpose.</p><p>Along with that I checked the <em>change password request</em> and found that it didn’t required the <em>current password.</em></p><p>This time I had found something which could easily allow me change victim’s password and takeover their account.</p><p>I mentioned this specifically in my report:</p><pre>We can create a javascript code which will first steal the victim&#39;s jwt token , then sends a request to the change password endpoint using the stolen jwt token, which will eventually allows us to takeover the victim&#39;s account. If you need a actual POC for this let me know, I am not providing it along the report as it will take time</pre><p>The program had a great response time so I received a response in a couple of hours after submitting the report and this happened:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1008/1*wHrSIWETkRpgDwuhmyF3wA.png" /></figure><p>It went back &amp; forth like 2–3 times then I didn’t said anything as they told me every time the same answer that they are already aware of the cookie policy and are doing a large effort to secure them. It was rewarded as a Medium severity which kinda sucks as the impact was much higher than that.</p><p>Btw guess what I just checked even after their continuous efforts the cookie’s policy is still same.</p><p>After a week or so the issue was fixed.</p><p>I just thought of checking the fix at that time and found a bypass which was pretty easy :)</p><p>This was the request made to upload the attachment</p><pre>POST /graphql HTTP/2<br>Host: x.example.com<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0<br>Authorization: Bearer Redacted<br>Content-Type: application/json<br>Content-Length: 59</pre><pre>{<br>  &quot;operationName&quot;: &quot;uploadFile&quot;,<br>  &quot;variables&quot;: {<br>    &quot;fileType&quot;: &quot;image/svg+xml&quot;,<br>    &quot;cId&quot;: &quot;1490072&quot;<br>  },<br>  &quot;query&quot;: &quot;mutation uploadFile($cId: ID!, $fileType: String!) {\n  uploadFile(cId: $cId, fileType: $fileType)\n}\n&quot;<br>}<br></pre><p>After the fix the application didn’t accepted the file if the Content-Type of the file was image/svg+xml , so to bypass it I tried different <em>content-types</em> of file such as image/svg , text/html ,etc and I found that text/xml was allowed, the xss popup again appeared .</p><p>The program had <strong><em>Retest </em></strong>enabled but they didn’t asked me to do so in the first report so I filed a new report and submitted it.</p><p>They confirmed the bypass I got rewarded with the same amount of bounty again.</p><p>Again a new fix was applied and the report was closed as <strong><em>Resolved </em></strong>this time also no <strong><em>Retest </em></strong>was asked.</p><p>Fired up my burp to check the fix and now along with image/svg+xml it also doesn’t accepts text/xml . Behind the scenes they probably had a whitelist filter which only accepted few content-type such as text/plain and other common ones.</p><p><a href="https://github.com/BlackFan/content-type-research/blob/master/XSS.md">content-type-research/XSS.md at master · BlackFan/content-type-research</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*b0JuiIMBnZtrT8vVaL1CpA.png" /></figure><p>fileType:text/html(xxx , fileType:text/html,xxx ,etc</p><p>I tried all of them to see if the application allowed any of them but none of them worked.</p><p>Then I came to a conclusion that the application validates the <em>content-type</em> from the extension of the uploaded file for <strong>eg</strong>: If I upload a file with name test.txt, the <strong><em>fileType</em></strong> parameter value will be text/plain in the <em>upload request</em>. So I uploaded the xss.svg file and changed the <strong><em>fileType</em></strong> parameter value from image/svg+xml (<em>which is not allowed</em>) to image/png (<em>which is allowed</em>) and the file was successfully uploaded</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/778/1*R4xAN14-8aq9EH_DOqBUkA.png" /><figcaption>Url of the uploaded file</figcaption></figure><pre>HTTP/2 200 OK<br><strong>Content-Type: image/svg+xml</strong><br>Content-Length: 416<br>Date: Mon, 27 Dec 2021 05:14:36 GMT<br>Last-Modified: Wed, 01 Sep 2021 04:52:51 GMT<br><strong>Content-Disposition: inline; filename=&quot;xss2.svg&quot;</strong><br>Accept-Ranges: bytes<br>Server: AmazonS3</pre><pre>&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt;<br>&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;<a href="http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd</a>&quot;&gt;<br>&lt;svg version=&quot;1.1&quot; baseProfile=&quot;full&quot; xmlns=&quot;<a href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>&quot; width=&quot;240px&quot; height=&quot;240px&quot;&gt;<br>   &lt;polygon id=&quot;triangle&quot; points=&quot;0,0 0,50 50,0&quot; fill=&quot;#009900&quot; stroke=&quot;#004400&quot;/&gt;<br>   &lt;script type=&quot;text/javascript&quot;&gt;<br>      alert(document.cookie);<br>   &lt;/script&gt;<br>&lt;/svg&gt;</pre><p>Made a new report , they verified the bypass and rewarded me (same amount as the previous ones).</p><p>And this time they asked for a retest :)</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/975/1*e0yxIXQ8h7b2D_glqzVyIA.png" /></figure><p>I confirmed their fix and found no bypass this time they did a great job this time. But wait the story doesn’t ends here.</p><p><strong><em>Here comes the twist in the story.</em></strong></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/961/1*FrIjPkdxafPsEpDMMEMikw.png" /></figure><p>So I checked the bug again and it was reproducible this time which I didn’t believe at all, I told them yeah I just tried reproducing it and found it still there. Sadly I didn’t had any video poc for the <strong><em>Retest </em></strong>so I can’t prove that this wasn’t reproducible before when I checked it.</p><p>After a week they pushed out a fix and when I checked it I could see a difference in the <em>upload request</em>:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1001/1*3mefiPxAQTLYA9jvOM29Yw.png" /></figure><pre>POST /graphql HTTP/2<br>Host: x.example.com<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0<br>Authorization: Bearer Redacted<br>Content-Type: application/json<br>Content-Length: 59</pre><pre>{<br>  &quot;operationName&quot;: &quot;uploadFile&quot;,<br>  &quot;variables&quot;: {<br>    &quot;fileType&quot;: &quot;image/svg+xml&quot;,<br>    <strong>&quot;fileName&quot;:&quot;xss2.svg&quot;,</strong><br>    &quot;cId&quot;: &quot;1490072&quot;<br>  },<br>  &quot;query&quot;: &quot;mutation uploadFile($cId: ID!, $fileType: String!) {\n  uploadFile(cId: $cId, fileType: $fileType)\n}\n&quot;<br>}</pre><p>A new parameter was added in the body, fileName . Now the application was validating both the <em>file name</em> and the file content-type .</p><p>In the above screenshot you can see that the <strong><em>Retest </em></strong>was rejected, so I told them that I didn’t get the $50 for the <strong><em>retest </em></strong>as it was rejected. This was their reply:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1009/1*iNoVkdeJP2Xycv-_ssdfaQ.png" /></figure><p>That was the moment I decided not to hack on their program ever again, btw <strong><em>Hackerone </em></strong>still showed that I had earned $50 for the retest which is kinda funny.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/993/1*Qm6ZzJfa7JBuP8kriFDVMQ.png" /></figure><blockquote>Always be careful with programs like this , in one of the talks from Frans Rosen he told that when hacking on a new program at first he sends only few low-hanging bug reports , to actually to find if the program is of worth his time or not. He doesn’t want to spend his precious time on a program where they don’t respect the hacker and don’t take security seriously .</blockquote><h4><strong>BUG: Private note disclosure via api endpoint</strong></h4><p>The bug which I am going to talk about now was really a very easy one, didn’t have much impact but still relatively easy to find.</p><p>It was a program which has been running for 4–5 years so it didn’t hope of finding something like this so easily. The application was a file sharing platform, where users can upload and share files with other users.</p><p>There was one feature which allows any user to set a password to their file, if anyone wants to access it they need to provide the password. Along with the file the owner could also send a note , both of them could only be visible to the end user when he provides the right password.</p><p>So I took the shared link and opened it in my browser, checked all the requests made after loading that url, the very first request was made to an /api endpoint.</p><pre><a href="https://example.com/api/file/v1/info?hash=xxxxxxxxxxxxxxxxx">https://example.com/api/file/v1/info?hash=xxxxxxxxxxxxxxxxx</a></pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/672/1*aEU8MsZzkUBq9M8jkj1YgA.png" /></figure><p>In the response you could see a description field which contains the note which was attached along with the file, this shouldn’t be disclosed in the response.</p><p>I was like no way this could have happened, I opened the same url again in the Incognito window and monitor the requests in burp. Found the same response.</p><p>Then I decided to report it I had a strong feeling this might have been already reported as it was so obvious you just need to load the url and watch the response , easy bug right?</p><p>Well it wasn’t reported by anyone else triaged and rewarded as a LOW severity vuln, even got fixed after few hours of reporting it.</p><h4>Bug: Disable any user’s acc by just knowing there email address</h4><p>Be ready now I am going to talk about a very interesting bug which was easy to find but also had so much impact</p><p>I got invited to this program quite a long time ago but didn’t find anything interesting during that time, someone disclosed their finding which was about a <strong><em>Full read ssrf </em></strong>bug found on the main scope .I was really amazed by this bug so I decided to spent more time on this program to see what I can find.</p><p>When you are hacking on a new program you can set some goals like I am going to do my best to submit at least 1 valid bug on this program, it’s ok even if you don’t find any bugs some targets are hard and have very good security posture. Move on try some different programs like programs with social media sites or B2B application or retails sites or etc , find what suits best for you.</p><p>Back to the bug ,…</p><p>I kinda love to look for <em>Improper access control </em>, <em>Privilege Escalation </em>bugs to find such bugs you need to dig deeper into the application , understand how different user roles are defined ,what actions can be performed only Admin’s acc,etc</p><p>The application which I was testing was an <em>Merchant portal</em>, where the owner can control their retail stores. We could also invite other users to our <em>merchant portal.</em></p><p>So I invited another user by entering the <em>email address</em>, a invitation email was sent to the user’s email address and now the invited user can access the merchant portal and perform actions based upon his Role</p><p>The access controls were setup pretty strong I wasn’t able to find any misconfiguration in any endpoint.</p><p>Back to the admin acc, I noticed that we can perform some actions such as change the invited user <em>username ,etc</em></p><p>I change the name to something else and then visited the invited user profile , the changes were successfully made. At that moment I realized that when I invited the user, an invitation mail was received which had the <strong><em>Invitation Confirmation Link </em></strong>and I correctly remembered that I didn’t clicked on it.</p><p>If you haven’t already figured out, let me tell what’s wrong here. The application doesn’t validates if the <em>invited user</em> has actually confirmed the <em>Invitation request</em> or not . The <em>invited user</em> is directly added to the <em>Merchant portal.</em></p><p>By just knowing some ones <em>email address</em> I could invite them to my <em>Merchant Portal </em>and then can make changes to their <strong><em>username (First name , Last name)</em></strong> without any user interaction at all.</p><p>I submitted this as soon as possible , after a few hours I noticed that I completely missed something . I could a lot more than just changing the invited user username. I can <em>enable 2fa on their acc , Disable login</em></p><p>The<em> invited user </em><strong><em>would never be able to login</em></strong> into his account until I remove him from my <em>Merchant Portal</em></p><p>Exact reply which I sent to them with further details:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*unkcZ9TP_alnoxSbSKwRgQ.png" /></figure><p>After few days I received the following updates on the report:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*CYUSNajlWBpsM8PPgvdhYg.png" /></figure><p>Well that got escalated quickly :)</p><p>There was one more scope which I wanted to test but the provided credentials weren’t working, so in the same report I asked them if they could look into this problem. They replied in a few hours with the new pair creds and I was ready to look at another scope now.</p><p>It was a completely different application from the <em>Merchant Portal</em></p><p>while looking around what all features it has I noticed a similar looking User Management endpoint which I have already seen in the <em>Merchant Portal</em></p><p>I decided to check for the same bug in this endpoint also and it worked !!!!!!!!!</p><p>The only problem was that I can’t perform any other actions rather than changing the victim’s name (<em>First name, Last name</em>) . other options like <em>enable 2fa, disable login</em> weren’t working here.</p><p>As it was a very similar issue to what I already reported , I decided to ask the <em>program-manager</em> what should I do file a new report (as it might be possible that both the application shares the same codebase, so only one fix was required).</p><p>The program-manager told me to file a new report and then they will verify it.</p><p>And then they rewarded for this report also :)</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/967/1*14a6pq_reUegf9ztkH86MQ.png" /></figure><p>I really like engaging with this program as they responded very quickly , the program-manager was also very nice.</p><h4><strong><em>BUG: CSRF in invite user action</em></strong></h4><p>It was a fairly new private program launched 2–3 months ago but had a good number of submissions and seemed very active. This application was also a <em>Merchant Portal </em>just like before.</p><p>I spent few time understanding the application, then started playing with the requests. In state changing requests such as (<strong><em>POST,PUT,DELETE</em></strong>) , there were many custom headers used along with X-CSRF-Token header.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*z5e9Tz3eiTdTxTS5-wHYzg.png" /></figure><p>Seeing so many custom headers along with the X-Nonce and X-CSRF-Token anyone wouldn’t be bother looking for CSRF bugs right?</p><p>I removed the X-CSRF-Token and forwarded the request, still successful. Then I thought they might be validating other <em>custom headers</em> for sure. One by one I removed the <em>custom headers</em> , but still the request was successful. Wow so they weren’t even validating any of those headers.</p><p>Then I needed to confirm one last thing whether the application accepts text/plain as the Content-Type of the request body or not, it worked :)</p><p>I created a poc and verified it then submitted the report, again had a doubt it might get duplicate as this was pretty easy to find.</p><p>This was a site-wide csrf issue which affected all the endpoints , the most sensitive endpoint was the one which I showed above <strong><em>Invite user action, </em></strong>so I used it as an example in my report to demonstrate the impact of this.</p><p>Next day I received a response from the team, I wasn’t expecting such type of response. I was quite amazed seeing their reaction to this report:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1023/1*Jg_Q9QH3Ao1O-_c-G0eJFw.png" /></figure><p>I will explain what the program-manager meant by his 2nd reply, to confirm the csrf bug . I created a csrf.html file and save the<em> csrf poc code</em> there</p><p>The below is similar to what you have already seen in the case of <em>Streamlab&#39;s csrf</em> poc</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*FpMY-PgPtXWXsSFWlm9Z8A.png" /></figure><p>I just opened the csrf.html file in my browser so the url was something like file:///Directory/csrf.html , in <strong><em>Firefox </em></strong>if the request is made from the file URI no <em>Origin </em>header is sent. If you try the same in other browsers such as Chrome you will notice the Origin: null header is sent.</p><p>The server accepts the requests without the Origin header</p><p>If you have read this writeup which I shared few days ago you might already know , how to deal with the Origin header .</p><p><a href="https://infosecwriteups.com/story-of-a-weird-csrf-bug-bde1129c106e">Story of a weird CSRF bug</a></p><p>I used the same trick iframe <em>data uri</em> to create a poc and updated the report with the working poc now.</p><p>Soon enough the program-manager validated the report</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/990/1*WeufhSRGtD-oROXA9GADsw.png" /></figure><p>I agreed to their reasoning and wasn’t even expecting that much amount so it was really grateful for them. .</p><h4><strong>BUG: Stealing vitcim’s access_token via open redirect</strong></h4><p>One thing which every bug hunter should do is to read disclosed reports on the <em>Hackitivity </em>on <strong>Hackerone</strong></p><p><a href="https://hackerone.com/hacktivity">HackerOne</a></p><p>If you want to take it one step further go ahead and try to reproduce the bug to confirm if it’s actually fixed or not.</p><p>Here is a diagram to explain what I am trying to say:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*f6fpI3cuCyDwV725g2HyoA.png" /></figure><p>Here’s an example of the diagram :</p><p>A report got disclosed in the <em>Hackitivity</em></p><p><a href="https://hackerone.com/reports/1178239">Logitech disclosed on HackerOne: session takeover via open protocol...</a></p><p>From the report I got to know about an endpoint:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/912/1*eIRU4wGsrojPbac_PiyHsg.png" /></figure><p>The attacker has control over the protocol part of the url, they describe it as <em>open protocol redirection</em> not <em>open redirect</em> as they don’t have full control over the url. just the protocol part.</p><p>After the fix the protocol is validated and now it only accepts http &amp; https. I am not sure if the reporter tried escalating the <em>open protocol redirection</em> to xss via javascript: as they had full control over the protocol part xss might be possible there.</p><p>Only streamlabs.com subdomain were whitelisted , if I try with any other url such as example.com an error will be thrown. I tried some variations also xstreamlabs.com , streamlabs.co.in ,etc to see if it works or not.</p><p>As nothing was working, I just though of searching for this endpoint in the <em>wayback machine</em> to see if I can find any other domain which is also in the whitelist.</p><p><a href="https://github.com/lc/gau">GitHub - lc/gau: Fetch known URLs from AlienVault&#39;s Open Threat Exchange, the Wayback Machine, and Common Crawl.</a></p><pre>https://streamlabs.com/global/identity?r=https://darthvapes.tv https://streamlabs.com/global/identity?r=https://dragynslair.live/ https://streamlabs.com/global/identity?r=https://franmg.net/merch https://streamlabs.com/global/identity?r=https://itzyony2.com https://streamlabs.com/global/identity?r=https://lmgtwitch.com https://streamlabs.com/global/identity?r=https://maitresharinganv1.com https://streamlabs.com/global/identity?r=https://themavshow.tv https://streamlabs.com/global/identity?r=https://veterangamertv.com https://streamlabs.com/global/identity?r=https://www.koopatroop.com https://streamlabs.com/global/identity?r=https://www.lokenplays.com https://streamlabs.com/global/identity?r=https://yagurlbubblezl4d.com</pre><p>From this I was able to find some more whitelisted domains:</p><pre>dragynslair.live <br>darthvapes.tv <br>nixxiom.tv</pre><p>If an authenticated user visits this url, his access_token will be sent to the dragynslair.live domain: <a href="https://streamlabs.com/global/identity?r=https://dragynslair.live/">https://streamlabs.com/global/identity?r=https://dragynslair.live/</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/969/1*3Kqa-hx9Ta4aG5t5EFIJOw.png" /></figure><p>The most interesting thing about this particular domain is that it was available for registration</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*pIXPCbEgB2aJtAPqyRUl1Q.png" /></figure><p>To prove my claim , I added an entry for dragynslair.live in my /ect/hosts file, this will allow me to confirm it without actually buying the domain</p><p>In this screenshot you can see the access_token was sent to my server.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*C5nLpitONn6GQwMbZ5gAmw.png" /></figure><p>The access_token could be used in the following endpoints:</p><p><a href="https://dev.streamlabs.com/reference">/authorize</a></p><p>The team just like last time lowered the severity without any explanation, which I already knew was going to happen as per my past experience from this program</p><h4>Bug: XSS filter bypass</h4><p>In this program it was clearly mentioned that if you find any <em>waf </em>bypass for eg like for <em>xss </em>they will treat the report as HIGH severity and reward accordingly.</p><p>The application had many functionalities so I was able to find an interesting endpoint, where the input was passed to the window.location sink.</p><p>The filter was working something like this: If I input javascript:alert() , it will end up like this</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/530/1*ujuuVa_Db-ey5k9rKFNXbw.png" /></figure><p>I tried uppercase JAVASCRIPT , mix uppercase-lowercase JaVaSCript but same thing happened.</p><p>Then I looked up on <strong><em>Portswigger xss cheatsheet</em></strong> to find more ways:</p><p><a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">Cross-Site Scripting (XSS) Cheat Sheet - 2024 Edition | Web Security Academy</a></p><pre>j&amp;#x61vascript:alert(1)<br>&amp;#X6A;avascript:alert(1)<br>javascript&amp;colon;alert(1)<br>java&amp;Tab;script:alert(1)<br>java&amp;NewLine;script:alert(1)<br>javascript&amp;colon;alert&amp;lpar;1&amp;rpar;</pre><pre>.............</pre><p>Then I started looking for other blogs , and stumble upon payloads which had <em>hex escape sequence </em>in them and this worked on my target I was able to bypass the filter</p><p><em>\x61 represents a</em></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/781/1*j0PCqzPioeNMz-w12vP6DA.png" /></figure><p>It was triaged and rewarded as a High Severity vuln.</p><h4><strong>BUG</strong>: STORED XSS</h4><p>I will be talking about one last bug which had the highest severity and also highest reward I have gotten for a bug so far.</p><p>It was a super new program, I could say I was on the group of people who were invited before anyone else.</p><p>I already had a very bad experience from another new program I submitted many bugs there such as <em>stored xss, csrf, access control bugs</em> even one bxss which triggered in one of their Admin panel. One by one they started closing the reports as <em>Informative &amp; Duplicate </em>stating that <em>csrf,access control, xss bugs</em> are <strong>site-wide</strong> so they will be only rewarding the first report which highlighted the problem.</p><p>I talked to other people also who were in the same program, all said the same thing site-wide , their reports also got closed as Duplicate because of that. A couple of months have already passed still they didn’t even paid out the reward for any valid bug also.</p><p>It was good lesson for me to not engage so much with new programs.</p><p>Back to the new private program, because of the past experience I was quite hesitant to hunt on this program but I still tried, the application was similar to Twitch where we can do streaming.</p><p>Users profile were public and there we could add any <em>spotify embed code</em> which would then be displayed to other user also.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/846/1*KVFugnSieTKNIZ4csfmv5Q.png" /></figure><p>In the above screenshot you can see an example of the embed code, btw if you have never heard of <strong><em>Darknet Diaries</em></strong> before you should start listening to this awesome podcast. Trust me you’ll love it :)</p><p><a href="https://darknetdiaries.com/">Darknet Diaries - True stories from the dark side of the Internet.</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*cQDlZgNr4wozbPzLIGtsgQ.png" /></figure><p>The application embedded this <em>iframe code</em> in the user’s profile, I started testing to see if I can take advantage of this functionality and add my own own arbitrary code to it .</p><p>I first started with a simple payload &lt;img src=x onerror=alert()&gt; , error returned not a valid <strong><em>Spotify Embed code , </em></strong>then I tried various other tags but it seems only frame was allowed.</p><p>So I started playing with the src attribute , if I can change it to src=javascript:alert() I will have an easy xss bug but the same error was received not a valid <strong><em>Spotify Embed code .</em></strong></p><p>I though of using srcdoc attribute but that also didn’t worked</p><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-srcdoc">: The Inline Frame element - HTML: HyperText Markup Language | MDN</a></p><p>After some time I thought why not just add an <em>on event handler</em> which will trigger when the src gets load, I added this <em>attribute </em>to the embed code onload=alert()</p><p>And it worked !! I could see the xss popup , this xss was in my public profile. So if any other user visits my website the xss wil be triggered.</p><p>I quickly submitted this issue and waited for their response. When dealing with such new programs , make sure you don’t waste time report the bug as soon as possible to make sure you don’t get duplicate , I already learned this lesson from some other programs.</p><p>There response time was really fast, they rewarded this xss as a HIGH severity vuln.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/988/1*jnRGJB7Yc_CPsmC30Btnew.png" /></figure><p>I was looking around and notice the application allows user’s to login via Google/Facebook , then I also find the settings from where we could <em>Add/Remove Google/facebook acc ,</em></p><p>so I was thinking using the xss bug I can easily takeover the victim&#39;s account as I have seen in some writeups.</p><p>I explained this to them and they verified my claim</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1011/1*2Zp5qzTN6aWwkLyI-qdrcA.png" /></figure><p>In total they rewarded me with $3200 for a Critical</p><p>This was the highest reward I have ever gotten for a reward so I was really very happy after this.</p><p>This year I started playing CTFs just for the web challenges, you are provided with the source code of the challenge as I am not good with source code reviewing doing this ctf challenges allows me to overcome my weaknesses. Also the challenge authors will often use some obsecure techinuqes which you want to be able to find anywhere else.</p><p>So if you want to improve your web hacking skills start playing some ctfs which have high rating points.</p><p>You can know about upcoming ctfs from here:</p><p><a href="https://ctftime.org/event/list/upcoming">CTFtime.org / All about CTF (Capture The Flag)</a></p><p>I know this was a really long read, I hope you didn’t get bored after reading this long writeup and learned one or two things from it.</p><p>That’s all, thankyou very much for reading it till the last. Hope you would have enjoyed it.</p><p>Goodluck for 2022 :)</p><p>Sya Everyoneeee</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=1fa60b28d949" width="1" height="1" alt=""><hr><p><a href="https://infosecwriteups.com/bug-hunting-journey-of-2021-1fa60b28d949">Bug Hunting Journey of 2021</a> was originally published in <a href="https://infosecwriteups.com">InfoSec Write-ups</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
