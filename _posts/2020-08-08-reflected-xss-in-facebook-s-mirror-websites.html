---
layout: post
title: Reflected XSS in Facebookâ€™s mirror websites
tag:
- xss-attack
- bug-bounty
---

<p>Heyyy Everyoneee,</p><p>I hope everyone is doing goodÂ , itâ€™s been a while since I havenâ€™t shared any writeup of my findingâ€™s.</p><p>This blog post is going to be about a reflected xss bug affecting Facebook mirror websites. I will be explaining the whole process how I found the vulnerable endpoint.</p><p>Well many people ask me how do I look for xss bugs so in this same blog I will also share my method of findingÂ xss.</p><p><strong>And here weÂ goâ€¦..</strong></p><p>I was collecting subdomains of <em>thefacebook.com</em> domain, as I have seen many writeups regarding bugs found in <em>thefacebook.com</em> subdomain only. I wanted to find something there tooÂ :)</p><p>Started with collecting the subdomains. I basically use tools like <a href="https://github.com/Edu4rdSHL/findomain">Findomain</a>, <a href="https://github.com/projectdiscovery/subfinder">Subfinder</a>,<a href="https://github.com/tomnomnom/assetfinder">AssetfinderÂ </a>,etc to find subdomains of my target. After I collected the subdomains I used another tool calledÂ <a href="https://github.com/tomnomnom/httprobe">httprobe</a></p><p>After the subdomain enumeration part is completed. I have a habit of doing directory bruteforcing(using <a href="https://github.com/ffuf/ffuf">ffuf</a>) on all the collected hosts from httprobe, then going through them to see if I can find some easy wins. Look at the below code thatâ€™s how I doÂ it</p><iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/090c82139ee692dbdfb18c077667cf6e/href">https://medium.com/media/090c82139ee692dbdfb18c077667cf6e/href</a></iframe><p>While I was looking at the <a href="https://mirror-ext.glbx.thefacebook.com">https://mirror-ext.glbx.thefacebook.com</a> ffufÂ result:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*V37IlwB7Jj9jkK7Q1BbgOA.png" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/770/1*AuwgYw1XzTN9auTi4y1Xkg.png" /></figure><p>Only one directory was there,I decided to look what might be there. <a href="http://mirror-ext.glbx.thefacebook.com/help/">http://mirror-ext.glbx.thefacebook.com/help/</a></p><p>It was normal help page with the support email address, didnâ€™t seem interesting to me at first but looking at the page source I could see something ineteresting.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*CWBINd1FlA55RBW7U8SVxA.png" /></figure><p>Look at the second line, I tried accessing that endpoint <a href="http://mirror-ext.glbx.thefacebook.com/.layout/mirror.php">http://mirror-ext.glbx.thefacebook.com/.layout/mirror.php</a> and it was just a blank pageÂ :(</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*QmYXGbF88Rt8EyJe7yXEfw.png" /></figure><p>This time there was nothing in the page source code too that I can look further into, then I decided to find more php endpoints under the /.layout directory.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/799/1*Gum98n_OHK8sL10gFkBd-A.png" /></figure><p>These were the files which I was able to find using different wordlists. They were all same as the earlier one mirror.php blank page, only one was different header.php</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*uCduM7R4xM6eZ0oPgCUE_A.png" /><figcaption><a href="http://mirror-ext.glbx.thefacebook.com/.layout/header.php">http://mirror-ext.glbx.thefacebook.com/.layout/header.php</a></figcaption></figure><p>Looking at the page source code I found that the endpoint was getting reflected inside anchor tag href value, it might be vulnerable to xss so I started testing forÂ it.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Hokf1IajT8Q5nme70RltFA.png" /></figure><p>Adding characters like â€œ&gt;&lt; at the end of the url gave <em>not foundÂ page</em>.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*iPNRJu_zZkOM3cUpyCR0Dg.png" /></figure><p>I didnâ€™t wanted to give up so easily as I can smell xss there. I started bruteforcing for parameters but didnâ€™t findÂ any.</p><p>Upon adding a slash and then another directory name didnâ€™t gave me the <em>not found error</em> like last time.I tried this because of @<a href="https://twitter.com/brutelogic/">brutelogic</a> blog which I read in theÂ past</p><p><a href="https://brutelogic.com.br/blog/looking-xss-php-source/">Looking for XSS in PHP Source Code - Brute XSS</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*bBM5RNMBo-P8bf0yBqqvBQ.png" /><figcaption><a href="http://mirror-ext.glbx.thefacebook.com/.layout/header.php/shirley">http://mirror-ext.glbx.thefacebook.com/.layout/header.php/shirley</a></figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/952/1*-3bSMsoRJdk_q4ERgoEXEA.png" /></figure><p>Trying again with <strong>â€œ&gt;&lt; </strong>and I found that they are getting urlÂ encoded.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/690/1*L4PlMR8OSDnc00ADRPAXDw.png" /></figure><p>Later I realised that the href value is inside single quotes. So trying with single quote thisÂ time.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/637/1*hwHPLWnI_Y-J_qCUZR2RRQ.png" /></figure><p>I tried this at first when I saw that my input was getting reflected inside href, href=â€™/javascript:alert()â€™, but this wasnâ€™t working because there is a slash before our input. I started looking on google for a way to include two href in a single anchor tagÂ , found a solution on <a href="https://stackoverflow.com/questions/13965753/how-can-i-open-multiple-links-using-a-single-anchor-tag">https://stackoverflow.com/questions/13965753/how-can-i-open-multiple-links-using-a-single-anchor-tag</a></p><p>Based upon the solutionÂ , the final payloadÂ was:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/771/1*hNUbkixtUQkfI8Rd_cUBIA.png" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*ZCfflRvZa0pfnxgp4SssKg.png" /></figure><p>I was like holy sh*t!! I just found a xss on a FacebookÂ domain.</p><p>Well I knew about some more Facebook mirror domains so tried to see if I can replicate the same xss on there also. ResultÂ was:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*SMq2UmmkpXCvHOj0gCB-Wg.png" /><figcaption>mirror.facebook.net</figcaption></figure><p>One more subdomain was vulnerable <a href="http://mirror.t.tfbnw.net/">http://mirror.t.tfbnw.net/</a> but I donâ€™t have any screenshot ofÂ it.</p><p>Thatâ€™s the end of theÂ story.</p><p>Regarding the fix, now the single quote(â€˜) is converted toÂ &amp;.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/797/1*-ONCYKIyjXg02ZlgTR5rHg.png" /></figure><p>I was rewarded with a $500 bounty for thisÂ xss.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/628/1*HQbUjGBT75pmkytvrde4aQ.png" /></figure><p><strong>Video POC:</strong></p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FTUMYeWTTfbM%3Ffeature%3Doembed&amp;display_name=YouTube&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DTUMYeWTTfbM&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FTUMYeWTTfbM%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" width="854" height="480" frameborder="0" scrolling="no"><a href="https://medium.com/media/0185a5889fe8bb9cb86515ce45415b34/href">https://medium.com/media/0185a5889fe8bb9cb86515ce45415b34/href</a></iframe><h3><strong>Now moving on to the secondÂ part,</strong></h3><p>How do I look for xssÂ bugs?</p><p>I am using this awesome burp plugin called <a href="https://github.com/elkokc/reflector">reflector</a></p><p><a href="https://github.com/elkokc/reflector">elkokc/reflector</a></p><p>It basically checks the parameter whose value is getting reflected in the source page and then tries to see which symbols are also getting reflected in the source page like <strong>â€œ,&gt;,&lt;,{,},â€™,etc</strong></p><p>You just need to browse the web applicationÂ , visit every page there, fill all the input fields. Then look at the burp issue tab to see if it has find anything.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/984/1*GGpB0hvYrnzre4_ml9bT5w.png" /><figcaption><a href="https://github.com/elkokc/reflector/blob/master/screenshot/symbols_analyse.png">https://github.com/elkokc/reflector/blob/master/screenshot/symbols_analyse.png</a></figcaption></figure><h4>Talking about some automation work:</h4><p>Use tools like paramspiderÂ , gauÂ ,etc to collect endpoints which have parameter in them then you can use kxss, dalfox (choice is yours, use whatever tool which works for you, they both are very good.) on them to see if you can find some xss. Below you can see the dalfox tool inÂ action</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*rCLGKqGObtkyvwrb4pYIaQ.png" /></figure><p><a href="https://twitter.com/0xAsm0d3us">https://twitter.com/0xAsm0d3us</a></p><p><a href="https://github.com/devanshbatham/ParamSpider">GitHub - devanshbatham/ParamSpider: Mining URLs from dark corners of Web Archives for bug hunting/fuzzing/further probing</a></p><p><a href="https://twitter.com/hacker_">https://twitter.com/hacker_</a></p><p><a href="https://github.com/lc/gau">GitHub - lc/gau: Fetch known URLs from AlienVault&#39;s Open Threat Exchange, the Wayback Machine, and Common Crawl.</a></p><p><a href="https://twitter.com/TomNomNom">https://twitter.com/TomNomNom</a></p><p><a href="https://github.com/tomnomnom/hacks/tree/master/kxss">tomnomnom/hacks</a></p><p><a href="https://twitter.com/hahwul">https://twitter.com/hahwul</a></p><p><a href="https://github.com/hahwul/dalfox">GitHub - hahwul/dalfox: ðŸŒ™ðŸ¦Š Dalfox is a powerful open-source XSS scanner and utility focused on automation.</a></p><h4>Beginner Guide</h4><p>If you are a beginner and want to learn about xss, start by reading blogs there are many great people writing blogs about xss like <a href="https://twitter.com/brutelogic">@brutelogic</a> (He is very kind and helpful. If you are having a hard time bypassing a xss waf or somethingÂ , he is always ready to help you there.Â )</p><p><a href="https://brutelogic.com.br/blog/">Brute XSS</a></p><p><a href="https://twitter.com/soaj1664ashar">https://twitter.com/soaj1664ashar</a></p><p><a href="https://respectxss.blogspot.com/">Respect XSS</a></p><p><a href="https://twitter.com/s0md3v">https://twitter.com/s0md3v</a></p><p><a href="https://github.com/s0md3v/AwesomeXSS">s0md3v/AwesomeXSS</a></p><p>There are many more just search them on google yourself.</p><p>Want to practise xss somewhere gotoÂ : <strong>Portswigger Web SecurityÂ Academy</strong></p><p><a href="https://portswigger.net/web-security/cross-site-scripting">What is cross-site scripting (XSS) and how to prevent it? | Web Security Academy</a></p><p>Do ctf challenges related to xss, watch poc videos/writeups they will give you an idea where you should look for xss, which fields are more prone to be vulnerable to xss eg. search fields, submit forms, etcÂ .</p><p>Thatâ€™s all, thankyou very much for reading it till the last. Hope you would have enjoyedÂ it.</p><p>Sya everyonee</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=4384b4eb3e11" width="1" height="1" alt=""><hr><p><a href="https://infosecwriteups.com/reflected-xss-in-facebooks-mirror-websites-4384b4eb3e11">Reflected XSS in Facebookâ€™s mirror websites</a> was originally published in <a href="https://infosecwriteups.com">InfoSec Write-ups</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
