---
layout: post
title: How I made it to Google HOF?
canonical_url: https://infosecwriteups.com/how-i-made-it-to-google-hof-f1cec85fdb1b?source=rss-738ac78f7fe8------2
tag:
- google-vrp
- idor-vulnerability
- xss-attack
- bug-bounty
---

<p>Heyyy Everyoneeee,</p><p>I know it’s been a quite long time since I shared any of my findings sorry about that, I am back now don’t worry :)</p><p>In this writeup I will be talking about some of my valid bugs which I submitted to Google VRP , as they are fixed now I can share the details.</p><p>One bug was a simple reflected xss in withgoogle.com subdomain which I was able to find using simple automation and the other two were IDORs which I found in appsheet.com , it’s an Acquisition of Google.</p><p>Without wasting anytime , let’s get started!</p><h3>XSS in artsexperiments.withgoogle.com</h3><p>I have been using this simple script to find some easy xss in the past, I am using two tools here one is Paramspider and the other one kxss.</p><p>As input I provide the script with a filename which contains a list of subdomains, then using for loop it iterates over the subdomain list one by one and finds any urls with parameters in them. Then it just pipe the output to the kxss tool which looks for reflection of certain characters like “,&gt;,&lt;,’ which can let you know whether the endpoint is vulnerable to xss or not.</p><iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/3644c9c679de183237777156ab158a73/href">https://medium.com/media/3644c9c679de183237777156ab158a73/href</a></iframe><ul><li><a href="https://github.com/devanshbatham/ParamSpider">GitHub - devanshbatham/ParamSpider: Mining URLs from dark corners of Web Archives for bug hunting/fuzzing/further probing</a></li><li><a href="https://github.com/tomnomnom/hacks/tree/master/kxss">tomnomnom/hacks</a></li></ul><p>I just collected the list of subdomains of withgoogle.com and then passed it to this script and found that “,&gt;,&lt;,’ these characters are getting reflected as it is.</p><p>Here is the url: <a href="https://www.google.com/url?q=https://artsexperiments.withgoogle.com/living-archive/?token%3D158753034&amp;sa=D&amp;usg=AFQjCNEQz64Oasdzq64DAeTLO3G42aLyMw">https://artsexperiments.withgoogle.com/living-archive/?token=158753034</a></p><p>And you can use any common payload here such as :</p><pre>“&gt;&lt;img src=x onerror=alert(document.domain)&gt;</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*EHrD0UmS1Ftlj4ehmsGMkg.png" /></figure><p>Now moving on to the IDOR</p><h3>IDOR in appsheet.com</h3><p>Well I was reading this article: <a href="https://medium.com/bugbountywriteup/the-short-tale-of-two-bugs-on-google-cloud-product-google-vrp-resolved-47c913dca8fc">https://medium.com/bugbountywriteup/the-short-tale-of-two-bugs-on-google-cloud-product-google-vrp-resolved-47c913dca8fc</a> (Sadly the author has deleted his writeup)</p><p>From this article I got to know about Appsheet which is in scope of the Google VRP, the author shared the details of the IDOR there.</p><p>So I decided to find the same ,as you might have heard <a href="https://twitter.com/zseano">Zseano </a>saying : “<strong><em>If there’s one IDOR… there will be plentyyy more</em></strong>”</p><p>I didn’t expected I will find a similar IDOR just same as the other hacker talked about in his writeup so easily, it didn’t took me more than a hour.</p><p>The endpoint was same , parameter too the only thing that was different was the Request method.</p><p>This was the endpoint <a href="https://www.appsheet.com/api/template/{appId}/">https://www.appsheet.com/api/template/{appId}/</a> , I found that the IDOR is fixed in GET method but the same IDOR still exists in POST method there was some data also in the body of the request .</p><p>This is the full request where I found the IDOR:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/903/1*IEgxRSQEQk1YifD6NU2mHg.png" /></figure><p>In the response you will get all the details of the app including the owner’s email , firebase token,etc.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*OiH9DciunBelfGKmfOwirw.png" /><figcaption>Truncated Response</figcaption></figure><p>I quickly submitted the report and I received response from the team that they can’t reproduce the IDOR for them it’s giving forbidden error when they are using other user’s appId in this request.</p><p>I then provided additional information and also to help them easily reproduce the bug I gave them a list of appId along with a curl request with my cookies in it.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*XRn1UxLorwcBU_ERug5VuA.png" /></figure><p>Atlast my report was accepted and on the next day itself they paid out a $500 bounty which was really fast.</p><p>The story doesn’t ends here wait for the climax.</p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fgiphy.com%2Fembed%2F3ohzAoZ3dfHQy8wggw%2Ftwitter%2Fiframe&amp;display_name=Giphy&amp;url=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2F3ohzAoZ3dfHQy8wggw%2Fgiphy.gif&amp;image=https%3A%2F%2Fi.giphy.com%2Fmedia%2F3ohzAoZ3dfHQy8wggw%2Fgiphy.gif&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=giphy" width="435" height="326" frameborder="0" scrolling="no"><a href="https://medium.com/media/7f649dd134f3018e6e293c9e64da95f9/href">https://medium.com/media/7f649dd134f3018e6e293c9e64da95f9/href</a></iframe><p>After 4 months , I got a reply from someone from the Google team stating that :</p><pre>This might not be actually a bug , they told me to look at my app settings to verify few things like which users are allowed to view my app(whether it&#39;s set to public or not),etc</pre><p>I replied stating that I used the default settings and didn’t made any changes .</p><p>They replied again:</p><pre>It seems that what you reported might be working as intended and that there is <strong>no security vulnerability</strong> and we were just confused.</pre><p>As I was also confused and had no idea where this is going, I replied to them:</p><pre>Hey XXXX,</pre><pre>Can you provide me with an appId which I shouldn&#39;t have access to?</pre><pre>If I am able to get the information related to that appId than this is indeed a bug which should be fixed or else if that&#39;s not the case you can close this report as intended behaviour.</pre><pre>Regards</pre><pre>Sudhanshu</pre><p>I took it as a challenge and was provided with an appId by Google team, fired up my burpsuite and I came to the conclusion that I am also getting the same error</p><pre>Your account sudi***@gmail.com id 2342347 does not have access to XXXX-1422495.</pre><p>I told them yeah they were right that this not a bug as I was not able to view any information related to their app. I wasn’t feeling good after knowing this wasn’t actually a bug and they still paid me bounty by mistake.</p><p>Next day, I decided to look again at appsheet.com to find a valid bug this time. I created a new app and after playing around the features , don’t know why I decided to check again for that IDOR .</p><p>I took the appId which the Google team member gave me and sent the request and this time it worked ! I was able to view details of their application.</p><p>Woot!! But I had no idea how it worked :(</p><p>I replied them again:</p><pre>Kindly ignore the previous message where I told that I wasn&#39;t able to get the information for your app.</pre><pre>Today I tried again and I was able to get information for your app.<br>Well well I am pretty sure this is your email only lastName<a href="mailto:straka.martin@gmail.com">.firstName@gmail.com</a> :)</pre><p>After closely looking at the request body parameter values the only thing that was changed from earlier was the version.</p><p>When I was confirming this IDOR for the first time in the post body , the <em>version </em>parameter value was set to 1.00003</p><p>And on the next day when I tried with a new app , the <em>version </em>parameter value was 1.000010</p><pre>{<br>  &quot;settings&quot;: null,<br>  &quot;getAllTables&quot;: true,<br>  &quot;syncsOnConsent&quot;: true,<br>  &quot;isPreview&quot;: true,<br>  &quot;apiLevel&quot;: 2,<br>  &quot;tzOffset&quot;: -330,<br>  &quot;locale&quot;: &quot;en-US&quot;,<br>  &quot;tableTimestamps&quot;: {},<br>  &quot;lastSyncTime&quot;: &quot;&quot;,<br>  &quot;appStartTime&quot;: &quot;&quot;,<br>  &quot;dataStamp&quot;: &quot;2021-01-17T11:32:42.705Z&quot;,<br>  &quot;clientId&quot;: &quot;4d9ef5e1-5cb0-400f-b432-660adcd24739&quot;,<br>  &quot;build&quot;: &quot;edf35e60c1c1fcaaa72a-1610841603810-bd06078&quot;,<br>  &quot;version&quot;: &quot;1.000010&quot;<br>}</pre><p>After noticing this little difference , I came to the conclusion that in order to get this IDOR working we need to supply the specific version which is associated with the App.</p><p>i.e. for my application the version was 1.00003and for the application of the Google staff was 1.000010</p><p>Due to this difference in version , we were both not able to reproduce the bug properly, as now everything was clear I explained everything to them again.</p><p>This were the replies I received after giving them the explanation:</p><pre>Hi Sudhanshu,<br><br>Nice, that&#39;s my testing application! Definitely a bug - thanks!<br><br>Regards,<br>XXXX, Google Security Team</pre><pre>-------------------------------------------------------------------</pre><pre><br>Hi Sudhanshu,<br><br>Thanks again for your report. I can confirm that this is indeed a valid bug. I&#39;ve also sent this report again to the VRP panel so they can have a look again.<br><br>Regards,<br>XXXXX, Google Security Team</pre><p>I was really happy after this as I proved that my bug was a valid one.</p><p>After a couple of weeks the bug was fixed and as a surprise they also awarded another $500 (which I didn’t expected at all).</p><p>The other IDOR which I talked about was in this endpoint: <a href="https://www.google.com/url?q=https://www.appsheet.com/api/loadApp/%7BappId%7D/?checkConsistency%3Dtrue&amp;sa=D&amp;usg=AFQjCNGKcIjIPJyAKHvEtyQDLmaVloiocQ">https://www.appsheet.com/api/loadApp/{appId}/?checkConsistency=true</a></p><p>The information disclosed in the response here didn’t have any sensitive info like owner’s email ,etc so although they fixed the issue , no bounty was awarded for the second IDOR.</p><p>That’s the end of the story.</p><p>Thankyou so much, if you have read it till the end really appreciate your time.</p><p>Syaa Everyonee</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=f1cec85fdb1b" width="1" height="1" alt=""><hr><p><a href="https://infosecwriteups.com/how-i-made-it-to-google-hof-f1cec85fdb1b">How I made it to Google HOF?</a> was originally published in <a href="https://infosecwriteups.com">InfoSec Write-ups</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
