<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Reflected XSS in Facebookâ€™s mirror websites | sudiâ€™s blog</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Reflected XSS in Facebookâ€™s mirror websites" />
<meta name="author" content="sudi" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Heyyy Everyoneee, I hope everyone is doing goodÂ , itâ€™s been a while since I havenâ€™t shared any writeup of my findingâ€™s. This blog post is going to be about a reflected xss bug affecting Facebook mirror websites. I will be explaining the whole process how I found the vulnerable endpoint. Well many people ask me how do I look for xss bugs so in this same blog I will also share my method of findingÂ xss. And here weÂ goâ€¦.. I was collecting subdomains of thefacebook.com domain, as I have seen many writeups regarding bugs found in thefacebook.com subdomain only. I wanted to find something there tooÂ :) Started with collecting the subdomains. I basically use tools like Findomain, Subfinder,AssetfinderÂ ,etc to find subdomains of my target. After I collected the subdomains I used another tool calledÂ httprobe After the subdomain enumeration part is completed. I have a habit of doing directory bruteforcing(using ffuf) on all the collected hosts from httprobe, then going through them to see if I can find some easy wins. Look at the below code thatâ€™s how I doÂ it https://medium.com/media/090c82139ee692dbdfb18c077667cf6e/href While I was looking at the https://mirror-ext.glbx.thefacebook.com ffufÂ result: Only one directory was there,I decided to look what might be there. http://mirror-ext.glbx.thefacebook.com/help/ It was normal help page with the support email address, didnâ€™t seem interesting to me at first but looking at the page source I could see something ineteresting. Look at the second line, I tried accessing that endpoint http://mirror-ext.glbx.thefacebook.com/.layout/mirror.php and it was just a blank pageÂ :( This time there was nothing in the page source code too that I can look further into, then I decided to find more php endpoints under the /.layout directory. These were the files which I was able to find using different wordlists. They were all same as the earlier one mirror.php blank page, only one was different header.php http://mirror-ext.glbx.thefacebook.com/.layout/header.php Looking at the page source code I found that the endpoint was getting reflected inside anchor tag href value, it might be vulnerable to xss so I started testing forÂ it. Adding characters like â€œ&gt;&lt; at the end of the url gave not foundÂ page. I didnâ€™t wanted to give up so easily as I can smell xss there. I started bruteforcing for parameters but didnâ€™t findÂ any. Upon adding a slash and then another directory name didnâ€™t gave me the not found error like last time.I tried this because of @brutelogic blog which I read in theÂ past Looking for XSS in PHP Source Code - Brute XSS http://mirror-ext.glbx.thefacebook.com/.layout/header.php/shirley Trying again with â€œ&gt;&lt; and I found that they are getting urlÂ encoded. Later I realised that the href value is inside single quotes. So trying with single quote thisÂ time. I tried this at first when I saw that my input was getting reflected inside href, href=â€™/javascript:alert()â€™, but this wasnâ€™t working because there is a slash before our input. I started looking on google for a way to include two href in a single anchor tagÂ , found a solution on https://stackoverflow.com/questions/13965753/how-can-i-open-multiple-links-using-a-single-anchor-tag Based upon the solutionÂ , the final payloadÂ was: I was like holy sh*t!! I just found a xss on a FacebookÂ domain. Well I knew about some more Facebook mirror domains so tried to see if I can replicate the same xss on there also. ResultÂ was: mirror.facebook.net One more subdomain was vulnerable http://mirror.t.tfbnw.net/ but I donâ€™t have any screenshot ofÂ it. Thatâ€™s the end of theÂ story. Regarding the fix, now the single quote(â€˜) is converted toÂ &amp;. I was rewarded with a $500 bounty for thisÂ xss. Video POC: https://medium.com/media/0185a5889fe8bb9cb86515ce45415b34/href Now moving on to the secondÂ part, How do I look for xssÂ bugs? I am using this awesome burp plugin called reflector elkokc/reflector It basically checks the parameter whose value is getting reflected in the source page and then tries to see which symbols are also getting reflected in the source page like â€œ,&gt;,&lt;,{,},â€™,etc You just need to browse the web applicationÂ , visit every page there, fill all the input fields. Then look at the burp issue tab to see if it has find anything. https://github.com/elkokc/reflector/blob/master/screenshot/symbols_analyse.png Talking about some automation work: Use tools like paramspiderÂ , gauÂ ,etc to collect endpoints which have parameter in them then you can use kxss, dalfox (choice is yours, use whatever tool which works for you, they both are very good.) on them to see if you can find some xss. Below you can see the dalfox tool inÂ action https://twitter.com/0xAsm0d3us GitHub - devanshbatham/ParamSpider: Mining URLs from dark corners of Web Archives for bug hunting/fuzzing/further probing https://twitter.com/hacker_ GitHub - lc/gau: Fetch known URLs from AlienVault&#39;s Open Threat Exchange, the Wayback Machine, and Common Crawl. https://twitter.com/TomNomNom tomnomnom/hacks https://twitter.com/hahwul GitHub - hahwul/dalfox: ðŸŒ™ðŸ¦Š Dalfox is a powerful open-source XSS scanner and utility focused on automation. Beginner Guide If you are a beginner and want to learn about xss, start by reading blogs there are many great people writing blogs about xss like @brutelogic (He is very kind and helpful. If you are having a hard time bypassing a xss waf or somethingÂ , he is always ready to help you there.Â ) Brute XSS https://twitter.com/soaj1664ashar Respect XSS https://twitter.com/s0md3v s0md3v/AwesomeXSS There are many more just search them on google yourself. Want to practise xss somewhere gotoÂ : Portswigger Web SecurityÂ Academy What is cross-site scripting (XSS) and how to prevent it? | Web Security Academy Do ctf challenges related to xss, watch poc videos/writeups they will give you an idea where you should look for xss, which fields are more prone to be vulnerable to xss eg. search fields, submit forms, etcÂ . Thatâ€™s all, thankyou very much for reading it till the last. Hope you would have enjoyedÂ it. Sya everyonee &lt;hr&gt;&lt;p&gt;Reflected XSS in Facebookâ€™s mirror websites was originally published in InfoSec Write-ups on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;" />
<meta property="og:description" content="Heyyy Everyoneee, I hope everyone is doing goodÂ , itâ€™s been a while since I havenâ€™t shared any writeup of my findingâ€™s. This blog post is going to be about a reflected xss bug affecting Facebook mirror websites. I will be explaining the whole process how I found the vulnerable endpoint. Well many people ask me how do I look for xss bugs so in this same blog I will also share my method of findingÂ xss. And here weÂ goâ€¦.. I was collecting subdomains of thefacebook.com domain, as I have seen many writeups regarding bugs found in thefacebook.com subdomain only. I wanted to find something there tooÂ :) Started with collecting the subdomains. I basically use tools like Findomain, Subfinder,AssetfinderÂ ,etc to find subdomains of my target. After I collected the subdomains I used another tool calledÂ httprobe After the subdomain enumeration part is completed. I have a habit of doing directory bruteforcing(using ffuf) on all the collected hosts from httprobe, then going through them to see if I can find some easy wins. Look at the below code thatâ€™s how I doÂ it https://medium.com/media/090c82139ee692dbdfb18c077667cf6e/href While I was looking at the https://mirror-ext.glbx.thefacebook.com ffufÂ result: Only one directory was there,I decided to look what might be there. http://mirror-ext.glbx.thefacebook.com/help/ It was normal help page with the support email address, didnâ€™t seem interesting to me at first but looking at the page source I could see something ineteresting. Look at the second line, I tried accessing that endpoint http://mirror-ext.glbx.thefacebook.com/.layout/mirror.php and it was just a blank pageÂ :( This time there was nothing in the page source code too that I can look further into, then I decided to find more php endpoints under the /.layout directory. These were the files which I was able to find using different wordlists. They were all same as the earlier one mirror.php blank page, only one was different header.php http://mirror-ext.glbx.thefacebook.com/.layout/header.php Looking at the page source code I found that the endpoint was getting reflected inside anchor tag href value, it might be vulnerable to xss so I started testing forÂ it. Adding characters like â€œ&gt;&lt; at the end of the url gave not foundÂ page. I didnâ€™t wanted to give up so easily as I can smell xss there. I started bruteforcing for parameters but didnâ€™t findÂ any. Upon adding a slash and then another directory name didnâ€™t gave me the not found error like last time.I tried this because of @brutelogic blog which I read in theÂ past Looking for XSS in PHP Source Code - Brute XSS http://mirror-ext.glbx.thefacebook.com/.layout/header.php/shirley Trying again with â€œ&gt;&lt; and I found that they are getting urlÂ encoded. Later I realised that the href value is inside single quotes. So trying with single quote thisÂ time. I tried this at first when I saw that my input was getting reflected inside href, href=â€™/javascript:alert()â€™, but this wasnâ€™t working because there is a slash before our input. I started looking on google for a way to include two href in a single anchor tagÂ , found a solution on https://stackoverflow.com/questions/13965753/how-can-i-open-multiple-links-using-a-single-anchor-tag Based upon the solutionÂ , the final payloadÂ was: I was like holy sh*t!! I just found a xss on a FacebookÂ domain. Well I knew about some more Facebook mirror domains so tried to see if I can replicate the same xss on there also. ResultÂ was: mirror.facebook.net One more subdomain was vulnerable http://mirror.t.tfbnw.net/ but I donâ€™t have any screenshot ofÂ it. Thatâ€™s the end of theÂ story. Regarding the fix, now the single quote(â€˜) is converted toÂ &amp;. I was rewarded with a $500 bounty for thisÂ xss. Video POC: https://medium.com/media/0185a5889fe8bb9cb86515ce45415b34/href Now moving on to the secondÂ part, How do I look for xssÂ bugs? I am using this awesome burp plugin called reflector elkokc/reflector It basically checks the parameter whose value is getting reflected in the source page and then tries to see which symbols are also getting reflected in the source page like â€œ,&gt;,&lt;,{,},â€™,etc You just need to browse the web applicationÂ , visit every page there, fill all the input fields. Then look at the burp issue tab to see if it has find anything. https://github.com/elkokc/reflector/blob/master/screenshot/symbols_analyse.png Talking about some automation work: Use tools like paramspiderÂ , gauÂ ,etc to collect endpoints which have parameter in them then you can use kxss, dalfox (choice is yours, use whatever tool which works for you, they both are very good.) on them to see if you can find some xss. Below you can see the dalfox tool inÂ action https://twitter.com/0xAsm0d3us GitHub - devanshbatham/ParamSpider: Mining URLs from dark corners of Web Archives for bug hunting/fuzzing/further probing https://twitter.com/hacker_ GitHub - lc/gau: Fetch known URLs from AlienVault&#39;s Open Threat Exchange, the Wayback Machine, and Common Crawl. https://twitter.com/TomNomNom tomnomnom/hacks https://twitter.com/hahwul GitHub - hahwul/dalfox: ðŸŒ™ðŸ¦Š Dalfox is a powerful open-source XSS scanner and utility focused on automation. Beginner Guide If you are a beginner and want to learn about xss, start by reading blogs there are many great people writing blogs about xss like @brutelogic (He is very kind and helpful. If you are having a hard time bypassing a xss waf or somethingÂ , he is always ready to help you there.Â ) Brute XSS https://twitter.com/soaj1664ashar Respect XSS https://twitter.com/s0md3v s0md3v/AwesomeXSS There are many more just search them on google yourself. Want to practise xss somewhere gotoÂ : Portswigger Web SecurityÂ Academy What is cross-site scripting (XSS) and how to prevent it? | Web Security Academy Do ctf challenges related to xss, watch poc videos/writeups they will give you an idea where you should look for xss, which fields are more prone to be vulnerable to xss eg. search fields, submit forms, etcÂ . Thatâ€™s all, thankyou very much for reading it till the last. Hope you would have enjoyedÂ it. Sya everyonee &lt;hr&gt;&lt;p&gt;Reflected XSS in Facebookâ€™s mirror websites was originally published in InfoSec Write-ups on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;" />
<link rel="canonical" href="http://localhost:4000/2020/08/08/reflected-xss-in-facebook-s-mirror-websites.html" />
<meta property="og:url" content="http://localhost:4000/2020/08/08/reflected-xss-in-facebook-s-mirror-websites.html" />
<meta property="og:site_name" content="sudiâ€™s blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-08T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Reflected XSS in Facebookâ€™s mirror websites" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"sudi"},"dateModified":"2020-08-08T00:00:00+05:30","datePublished":"2020-08-08T00:00:00+05:30","description":"Heyyy Everyoneee, I hope everyone is doing goodÂ , itâ€™s been a while since I havenâ€™t shared any writeup of my findingâ€™s. This blog post is going to be about a reflected xss bug affecting Facebook mirror websites. I will be explaining the whole process how I found the vulnerable endpoint. Well many people ask me how do I look for xss bugs so in this same blog I will also share my method of findingÂ xss. And here weÂ goâ€¦.. I was collecting subdomains of thefacebook.com domain, as I have seen many writeups regarding bugs found in thefacebook.com subdomain only. I wanted to find something there tooÂ :) Started with collecting the subdomains. I basically use tools like Findomain, Subfinder,AssetfinderÂ ,etc to find subdomains of my target. After I collected the subdomains I used another tool calledÂ httprobe After the subdomain enumeration part is completed. I have a habit of doing directory bruteforcing(using ffuf) on all the collected hosts from httprobe, then going through them to see if I can find some easy wins. Look at the below code thatâ€™s how I doÂ it https://medium.com/media/090c82139ee692dbdfb18c077667cf6e/href While I was looking at the https://mirror-ext.glbx.thefacebook.com ffufÂ result: Only one directory was there,I decided to look what might be there. http://mirror-ext.glbx.thefacebook.com/help/ It was normal help page with the support email address, didnâ€™t seem interesting to me at first but looking at the page source I could see something ineteresting. Look at the second line, I tried accessing that endpoint http://mirror-ext.glbx.thefacebook.com/.layout/mirror.php and it was just a blank pageÂ :( This time there was nothing in the page source code too that I can look further into, then I decided to find more php endpoints under the /.layout directory. These were the files which I was able to find using different wordlists. They were all same as the earlier one mirror.php blank page, only one was different header.php http://mirror-ext.glbx.thefacebook.com/.layout/header.php Looking at the page source code I found that the endpoint was getting reflected inside anchor tag href value, it might be vulnerable to xss so I started testing forÂ it. Adding characters like â€œ&gt;&lt; at the end of the url gave not foundÂ page. I didnâ€™t wanted to give up so easily as I can smell xss there. I started bruteforcing for parameters but didnâ€™t findÂ any. Upon adding a slash and then another directory name didnâ€™t gave me the not found error like last time.I tried this because of @brutelogic blog which I read in theÂ past Looking for XSS in PHP Source Code - Brute XSS http://mirror-ext.glbx.thefacebook.com/.layout/header.php/shirley Trying again with â€œ&gt;&lt; and I found that they are getting urlÂ encoded. Later I realised that the href value is inside single quotes. So trying with single quote thisÂ time. I tried this at first when I saw that my input was getting reflected inside href, href=â€™/javascript:alert()â€™, but this wasnâ€™t working because there is a slash before our input. I started looking on google for a way to include two href in a single anchor tagÂ , found a solution on https://stackoverflow.com/questions/13965753/how-can-i-open-multiple-links-using-a-single-anchor-tag Based upon the solutionÂ , the final payloadÂ was: I was like holy sh*t!! I just found a xss on a FacebookÂ domain. Well I knew about some more Facebook mirror domains so tried to see if I can replicate the same xss on there also. ResultÂ was: mirror.facebook.net One more subdomain was vulnerable http://mirror.t.tfbnw.net/ but I donâ€™t have any screenshot ofÂ it. Thatâ€™s the end of theÂ story. Regarding the fix, now the single quote(â€˜) is converted toÂ &amp;. I was rewarded with a $500 bounty for thisÂ xss. Video POC: https://medium.com/media/0185a5889fe8bb9cb86515ce45415b34/href Now moving on to the secondÂ part, How do I look for xssÂ bugs? I am using this awesome burp plugin called reflector elkokc/reflector It basically checks the parameter whose value is getting reflected in the source page and then tries to see which symbols are also getting reflected in the source page like â€œ,&gt;,&lt;,{,},â€™,etc You just need to browse the web applicationÂ , visit every page there, fill all the input fields. Then look at the burp issue tab to see if it has find anything. https://github.com/elkokc/reflector/blob/master/screenshot/symbols_analyse.png Talking about some automation work: Use tools like paramspiderÂ , gauÂ ,etc to collect endpoints which have parameter in them then you can use kxss, dalfox (choice is yours, use whatever tool which works for you, they both are very good.) on them to see if you can find some xss. Below you can see the dalfox tool inÂ action https://twitter.com/0xAsm0d3us GitHub - devanshbatham/ParamSpider: Mining URLs from dark corners of Web Archives for bug hunting/fuzzing/further probing https://twitter.com/hacker_ GitHub - lc/gau: Fetch known URLs from AlienVault&#39;s Open Threat Exchange, the Wayback Machine, and Common Crawl. https://twitter.com/TomNomNom tomnomnom/hacks https://twitter.com/hahwul GitHub - hahwul/dalfox: ðŸŒ™ðŸ¦Š Dalfox is a powerful open-source XSS scanner and utility focused on automation. Beginner Guide If you are a beginner and want to learn about xss, start by reading blogs there are many great people writing blogs about xss like @brutelogic (He is very kind and helpful. If you are having a hard time bypassing a xss waf or somethingÂ , he is always ready to help you there.Â ) Brute XSS https://twitter.com/soaj1664ashar Respect XSS https://twitter.com/s0md3v s0md3v/AwesomeXSS There are many more just search them on google yourself. Want to practise xss somewhere gotoÂ : Portswigger Web SecurityÂ Academy What is cross-site scripting (XSS) and how to prevent it? | Web Security Academy Do ctf challenges related to xss, watch poc videos/writeups they will give you an idea where you should look for xss, which fields are more prone to be vulnerable to xss eg. search fields, submit forms, etcÂ . Thatâ€™s all, thankyou very much for reading it till the last. Hope you would have enjoyedÂ it. Sya everyonee &lt;hr&gt;&lt;p&gt;Reflected XSS in Facebookâ€™s mirror websites was originally published in InfoSec Write-ups on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;","headline":"Reflected XSS in Facebookâ€™s mirror websites","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/08/08/reflected-xss-in-facebook-s-mirror-websites.html"},"url":"http://localhost:4000/2020/08/08/reflected-xss-in-facebook-s-mirror-websites.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="sudi&apos;s blog" />
<script src="//cdn.jsdelivr.net/npm/@microlink/vanilla@latest/umd/microlink.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function (event) {
    microlink('.card-preview')
  })
</script>
  
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">sudi&#39;s blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Reflected XSS in Facebookâ€™s mirror websites</h1>
    <p class="post-meta"><time class="dt-published" datetime="2020-08-08T00:00:00+05:30" itemprop="datePublished">
        Aug 8, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Heyyy Everyoneee,</p><p>I hope everyone is doing goodÂ , itâ€™s been a while since I havenâ€™t shared any writeup of my findingâ€™s.</p><p>This blog post is going to be about a reflected xss bug affecting Facebook mirror websites. I will be explaining the whole process how I found the vulnerable endpoint.</p><p>Well many people ask me how do I look for xss bugs so in this same blog I will also share my method of findingÂ xss.</p><p><strong>And here weÂ goâ€¦..</strong></p><p>I was collecting subdomains of <em>thefacebook.com</em> domain, as I have seen many writeups regarding bugs found in <em>thefacebook.com</em> subdomain only. I wanted to find something there tooÂ :)</p><p>Started with collecting the subdomains. I basically use tools like <a href="https://github.com/Edu4rdSHL/findomain">Findomain</a>, <a href="https://github.com/projectdiscovery/subfinder">Subfinder</a>,<a href="https://github.com/tomnomnom/assetfinder">AssetfinderÂ </a>,etc to find subdomains of my target. After I collected the subdomains I used another tool calledÂ <a href="https://github.com/tomnomnom/httprobe">httprobe</a></p><p>After the subdomain enumeration part is completed. I have a habit of doing directory bruteforcing(using <a href="https://github.com/ffuf/ffuf">ffuf</a>) on all the collected hosts from httprobe, then going through them to see if I can find some easy wins. Look at the below code thatâ€™s how I doÂ it</p><iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/090c82139ee692dbdfb18c077667cf6e/href">https://medium.com/media/090c82139ee692dbdfb18c077667cf6e/href</a></iframe><p>While I was looking at the <a href="https://mirror-ext.glbx.thefacebook.com">https://mirror-ext.glbx.thefacebook.com</a> ffufÂ result:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*V37IlwB7Jj9jkK7Q1BbgOA.png" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/770/1*AuwgYw1XzTN9auTi4y1Xkg.png" /></figure><p>Only one directory was there,I decided to look what might be there. <a href="http://mirror-ext.glbx.thefacebook.com/help/">http://mirror-ext.glbx.thefacebook.com/help/</a></p><p>It was normal help page with the support email address, didnâ€™t seem interesting to me at first but looking at the page source I could see something ineteresting.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*CWBINd1FlA55RBW7U8SVxA.png" /></figure><p>Look at the second line, I tried accessing that endpoint <a href="http://mirror-ext.glbx.thefacebook.com/.layout/mirror.php">http://mirror-ext.glbx.thefacebook.com/.layout/mirror.php</a> and it was just a blank pageÂ :(</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*QmYXGbF88Rt8EyJe7yXEfw.png" /></figure><p>This time there was nothing in the page source code too that I can look further into, then I decided to find more php endpoints under the /.layout directory.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/799/1*Gum98n_OHK8sL10gFkBd-A.png" /></figure><p>These were the files which I was able to find using different wordlists. They were all same as the earlier one mirror.php blank page, only one was different header.php</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*uCduM7R4xM6eZ0oPgCUE_A.png" /><figcaption><a href="http://mirror-ext.glbx.thefacebook.com/.layout/header.php">http://mirror-ext.glbx.thefacebook.com/.layout/header.php</a></figcaption></figure><p>Looking at the page source code I found that the endpoint was getting reflected inside anchor tag href value, it might be vulnerable to xss so I started testing forÂ it.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Hokf1IajT8Q5nme70RltFA.png" /></figure><p>Adding characters like â€œ&gt;&lt; at the end of the url gave <em>not foundÂ page</em>.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*iPNRJu_zZkOM3cUpyCR0Dg.png" /></figure><p>I didnâ€™t wanted to give up so easily as I can smell xss there. I started bruteforcing for parameters but didnâ€™t findÂ any.</p><p>Upon adding a slash and then another directory name didnâ€™t gave me the <em>not found error</em> like last time.I tried this because of @<a href="https://twitter.com/brutelogic/">brutelogic</a> blog which I read in theÂ past</p><p><a href="https://brutelogic.com.br/blog/looking-xss-php-source/">Looking for XSS in PHP Source Code - Brute XSS</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*bBM5RNMBo-P8bf0yBqqvBQ.png" /><figcaption><a href="http://mirror-ext.glbx.thefacebook.com/.layout/header.php/shirley">http://mirror-ext.glbx.thefacebook.com/.layout/header.php/shirley</a></figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/952/1*-3bSMsoRJdk_q4ERgoEXEA.png" /></figure><p>Trying again with <strong>â€œ&gt;&lt; </strong>and I found that they are getting urlÂ encoded.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/690/1*L4PlMR8OSDnc00ADRPAXDw.png" /></figure><p>Later I realised that the href value is inside single quotes. So trying with single quote thisÂ time.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/637/1*hwHPLWnI_Y-J_qCUZR2RRQ.png" /></figure><p>I tried this at first when I saw that my input was getting reflected inside href, href=â€™/javascript:alert()â€™, but this wasnâ€™t working because there is a slash before our input. I started looking on google for a way to include two href in a single anchor tagÂ , found a solution on <a href="https://stackoverflow.com/questions/13965753/how-can-i-open-multiple-links-using-a-single-anchor-tag">https://stackoverflow.com/questions/13965753/how-can-i-open-multiple-links-using-a-single-anchor-tag</a></p><p>Based upon the solutionÂ , the final payloadÂ was:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/771/1*hNUbkixtUQkfI8Rd_cUBIA.png" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*ZCfflRvZa0pfnxgp4SssKg.png" /></figure><p>I was like holy sh*t!! I just found a xss on a FacebookÂ domain.</p><p>Well I knew about some more Facebook mirror domains so tried to see if I can replicate the same xss on there also. ResultÂ was:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*SMq2UmmkpXCvHOj0gCB-Wg.png" /><figcaption>mirror.facebook.net</figcaption></figure><p>One more subdomain was vulnerable <a href="http://mirror.t.tfbnw.net/">http://mirror.t.tfbnw.net/</a> but I donâ€™t have any screenshot ofÂ it.</p><p>Thatâ€™s the end of theÂ story.</p><p>Regarding the fix, now the single quote(â€˜) is converted toÂ &amp;.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/797/1*-ONCYKIyjXg02ZlgTR5rHg.png" /></figure><p>I was rewarded with a $500 bounty for thisÂ xss.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/628/1*HQbUjGBT75pmkytvrde4aQ.png" /></figure><p><strong>Video POC:</strong></p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FTUMYeWTTfbM%3Ffeature%3Doembed&amp;display_name=YouTube&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DTUMYeWTTfbM&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FTUMYeWTTfbM%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" width="854" height="480" frameborder="0" scrolling="no"><a href="https://medium.com/media/0185a5889fe8bb9cb86515ce45415b34/href">https://medium.com/media/0185a5889fe8bb9cb86515ce45415b34/href</a></iframe><h3><strong>Now moving on to the secondÂ part,</strong></h3><p>How do I look for xssÂ bugs?</p><p>I am using this awesome burp plugin called <a href="https://github.com/elkokc/reflector">reflector</a></p><p><a href="https://github.com/elkokc/reflector">elkokc/reflector</a></p><p>It basically checks the parameter whose value is getting reflected in the source page and then tries to see which symbols are also getting reflected in the source page like <strong>â€œ,&gt;,&lt;,{,},â€™,etc</strong></p><p>You just need to browse the web applicationÂ , visit every page there, fill all the input fields. Then look at the burp issue tab to see if it has find anything.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/984/1*GGpB0hvYrnzre4_ml9bT5w.png" /><figcaption><a href="https://github.com/elkokc/reflector/blob/master/screenshot/symbols_analyse.png">https://github.com/elkokc/reflector/blob/master/screenshot/symbols_analyse.png</a></figcaption></figure><h4>Talking about some automation work:</h4><p>Use tools like paramspiderÂ , gauÂ ,etc to collect endpoints which have parameter in them then you can use kxss, dalfox (choice is yours, use whatever tool which works for you, they both are very good.) on them to see if you can find some xss. Below you can see the dalfox tool inÂ action</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*rCLGKqGObtkyvwrb4pYIaQ.png" /></figure><p><a href="https://twitter.com/0xAsm0d3us">https://twitter.com/0xAsm0d3us</a></p><p><a href="https://github.com/devanshbatham/ParamSpider">GitHub - devanshbatham/ParamSpider: Mining URLs from dark corners of Web Archives for bug hunting/fuzzing/further probing</a></p><p><a href="https://twitter.com/hacker_">https://twitter.com/hacker_</a></p><p><a href="https://github.com/lc/gau">GitHub - lc/gau: Fetch known URLs from AlienVault&#39;s Open Threat Exchange, the Wayback Machine, and Common Crawl.</a></p><p><a href="https://twitter.com/TomNomNom">https://twitter.com/TomNomNom</a></p><p><a href="https://github.com/tomnomnom/hacks/tree/master/kxss">tomnomnom/hacks</a></p><p><a href="https://twitter.com/hahwul">https://twitter.com/hahwul</a></p><p><a href="https://github.com/hahwul/dalfox">GitHub - hahwul/dalfox: ðŸŒ™ðŸ¦Š Dalfox is a powerful open-source XSS scanner and utility focused on automation.</a></p><h4>Beginner Guide</h4><p>If you are a beginner and want to learn about xss, start by reading blogs there are many great people writing blogs about xss like <a href="https://twitter.com/brutelogic">@brutelogic</a> (He is very kind and helpful. If you are having a hard time bypassing a xss waf or somethingÂ , he is always ready to help you there.Â )</p><p><a href="https://brutelogic.com.br/blog/">Brute XSS</a></p><p><a href="https://twitter.com/soaj1664ashar">https://twitter.com/soaj1664ashar</a></p><p><a href="https://respectxss.blogspot.com/">Respect XSS</a></p><p><a href="https://twitter.com/s0md3v">https://twitter.com/s0md3v</a></p><p><a href="https://github.com/s0md3v/AwesomeXSS">s0md3v/AwesomeXSS</a></p><p>There are many more just search them on google yourself.</p><p>Want to practise xss somewhere gotoÂ : <strong>Portswigger Web SecurityÂ Academy</strong></p><p><a href="https://portswigger.net/web-security/cross-site-scripting">What is cross-site scripting (XSS) and how to prevent it? | Web Security Academy</a></p><p>Do ctf challenges related to xss, watch poc videos/writeups they will give you an idea where you should look for xss, which fields are more prone to be vulnerable to xss eg. search fields, submit forms, etcÂ .</p><p>Thatâ€™s all, thankyou very much for reading it till the last. Hope you would have enjoyedÂ it.</p><p>Sya everyonee</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=4384b4eb3e11" width="1" height="1" alt=""><hr><p><a href="https://infosecwriteups.com/reflected-xss-in-facebooks-mirror-websites-4384b4eb3e11">Reflected XSS in Facebookâ€™s mirror websites</a> was originally published in <a href="https://infosecwriteups.com">InfoSec Write-ups</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>

  </div><a class="u-url" href="/2020/08/08/reflected-xss-in-facebook-s-mirror-websites.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">sudi</li>
          <li><a class="u-email" href="mailto:sudi[at]wearehackerone.com">sudi[at]wearehackerone.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
