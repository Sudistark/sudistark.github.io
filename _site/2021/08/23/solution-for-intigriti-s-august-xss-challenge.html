<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Solution for Intigritiâ€™s August XSS challenge | Your awesome title</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Solution for Intigritiâ€™s August XSS challenge" />
<meta name="author" content="GitHub User" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Heyyy Everyoneee, In this blog, I will be discussing the solution for the Intigritiâ€™s August XSS challenge. INTIGRITI on Twitter: &quot;â° It&#39;s CHALLENGE O&#39;CLOCK!ğŸ‘‰ Find the XSS before Sunday August 22nd, 23:59 CETğŸ‘‰ Win â‚¬300 in SWAG prizesğŸ‘‰ We&#39;ll release a tip on our Discord (Check replies for link) for every 100 likes on this tweet!Thanks @WHOISbinit for the challenge! ğŸ‘‡https://t.co/f631AbNmXf / Twitter&quot; â° It&#39;s CHALLENGE O&#39;CLOCK!ğŸ‘‰ Find the XSS before Sunday August 22nd, 23:59 CETğŸ‘‰ Win â‚¬300 in SWAG prizesğŸ‘‰ We&#39;ll release a tip on our Discord (Check replies for link) for every 100 likes on this tweet!Thanks @WHOISbinit for the challenge! ğŸ‘‡https://t.co/f631AbNmXf This will be a step by step walkthrough how I was able to find the xss vulnerability. Opening the challenge url, we can see that this endpoint https://challenge-0821.intigriti.io/challenge/cooking.html is loaded in the home page in anÂ iframe. Under collections you will find 3 urls which are having a base64 encoding string in the recipe parameter. Here is the url for the collection which says The basicÂ XSS: https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=dGl0bGU9VGhlJTIwU1ZHJmluZ3JlZGllbnRzJTVCJTVEPUFuJTIwU1ZHJTIwdGFnJmluZ3JlZGllbnRzJTVCJTVEPVNvbWUlMjBqYXZhc2NyaXB0JmluZ3JlZGllbnRzJTVCJTVEPVNvbWUlMjBvbmxvYWQlMjBhY3Rpb24mcGF5bG9hZD0lM0NzdmclMjBvbmxvYWQlMjUzRGFsZXJ0KDEpJTNFJnN0ZXBzJTVCJTVEPUZpbmQlMjB0YXJnZXQmc3RlcHMlNUIlNUQ9SW5qZWN0JnN0ZXBzJTVCJTVEPUFMRVJUIQ== Upon opening the above urlÂ , you can notice that under Recipe, now itâ€™s not showing undefined likeÂ before. By decoding the base64 encoded string, we now know where these values cameÂ from. I modified the parameter values to a xss payload and then re encoded it to base64 to see if the xss payload works or not. It didnâ€™tÂ work From the js code (main.js), you can see that these parameter values are passed to innerText (which is a safe approachÂ here) https://medium.com/media/1b1fe0414450d49506ed8432d3de16bb/href As it was not possible to do anything from the recipe parameter, I started reading the js code to see where this username unknownUser281 cameÂ from. After reading the code I found that this username is taken from theÂ cookie: The code first reads the value for the cookie username parameter and then pass on line no 18 to the innerHTML https://medium.com/media/6dc2a8b0331669f82135df44054b9490/href At this point I thought if we can somehow take control over this cookie parameter we can easily get a xss as the value of the username cookie parameter is passed to innerHTML. We can verify the same by changing the cookie to a xss payload and here in this screenshot you can see that this actuallyÂ works: Itâ€™s a self xss for now, now we need to find a way to change it with some anotherÂ way. On line no 52Â , the decoded value of the recipe parameter is passed to the deparam function. jquery-deparam If you know already about the author of this challenge @WHOISbinit, you are aware that he has shared some great prototype pollution challenges in theÂ past. In one of his challenges he used the same vulnerable deparampackage.So it became very clear what I had to doÂ next. For more info regarding this you can read the belowÂ blogs: Snyk - Prototype Pollution in jquery-deparamclient-side-prototype-pollution/pp/jquery-deparam.md at master Â· BlackFan/client-side-prototype-pollution If you are new to prototype pollutionÂ , I recommend watching this twoÂ videos: https://medium.com/media/47f8a3fffdcd03d50611c40ff8ec8ddd/href https://medium.com/media/c6b15db0b1ac623c38b5375f49247992/href Now letâ€™s move on to prototype pollution, At first I started with a basic payload __proto__[test]=test If this payload works every object will have a new property name test with valueÂ test In this url, I have encoded the payload as if you remember the code from line 52Â , that the application first decodes the base64 string then it is used in the deparam function, so in order to make it work we have base64 encoded ourÂ payload. Cooking with Intigriti It workedÂ , the test property has been added successfully. Now we already know about the sink (innerHtml), have a working prototype pollution payload. The only missing thing is a script gadget which will allow us to make modification to the cookie parameterâ€™s value. Looking for a script gadgetâ€¦.. When it comes to prototype pollution, this repo is super useful. It contains the list of vulnerable packages with working payloads along with script gadgets in popular js files such as in our case itâ€™s Google analytics: GitHub - BlackFan/client-side-prototype-pollution: Prototype Pollution and useful Script Gadgets Along with importing the deparam js file, one more is imported Google Analytics The above mentioned repo also has a script gadget for the Google analytics.js client-side-prototype-pollution/google-analytics.md at master Â· BlackFan/client-side-prototype-pollution ?__proto__[cookieName]=COOKIE%3DInjection%3B Bingo exactly what we were looking for, this will allow us to change the usernamecookie parameter value to a xssÂ payload. Again first verifying it before adding the xssÂ payload: __proto__[cookieName]=username%3Dshirley%3B https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW2Nvb2tpZU5hbWVdPXVzZXJuYW1lJTNEc2hpcmxleSUzQg== As itâ€™s perfectly fine we will add the xss payloadÂ now: __proto__[cookieName]=username%3Dshirley%3Cimg%20src%3Dx%20onerror%3Dalert%28document.domain%29%3E%3B And here we goÂ , we successfully executed theÂ popup: https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW2Nvb2tpZU5hbWVdPXVzZXJuYW1lJTNEc2hpcmxleSUzQ2ltZyUyMHNyYyUzRHglMjBvbmVycm9yJTNEYWxlcnQlMjhkb2N1bWVudC5kb21haW4lMjklM0UlM0I= Thankyou for reading it till the lastÂ :) Sya Everyonee!" />
<meta property="og:description" content="Heyyy Everyoneee, In this blog, I will be discussing the solution for the Intigritiâ€™s August XSS challenge. INTIGRITI on Twitter: &quot;â° It&#39;s CHALLENGE O&#39;CLOCK!ğŸ‘‰ Find the XSS before Sunday August 22nd, 23:59 CETğŸ‘‰ Win â‚¬300 in SWAG prizesğŸ‘‰ We&#39;ll release a tip on our Discord (Check replies for link) for every 100 likes on this tweet!Thanks @WHOISbinit for the challenge! ğŸ‘‡https://t.co/f631AbNmXf / Twitter&quot; â° It&#39;s CHALLENGE O&#39;CLOCK!ğŸ‘‰ Find the XSS before Sunday August 22nd, 23:59 CETğŸ‘‰ Win â‚¬300 in SWAG prizesğŸ‘‰ We&#39;ll release a tip on our Discord (Check replies for link) for every 100 likes on this tweet!Thanks @WHOISbinit for the challenge! ğŸ‘‡https://t.co/f631AbNmXf This will be a step by step walkthrough how I was able to find the xss vulnerability. Opening the challenge url, we can see that this endpoint https://challenge-0821.intigriti.io/challenge/cooking.html is loaded in the home page in anÂ iframe. Under collections you will find 3 urls which are having a base64 encoding string in the recipe parameter. Here is the url for the collection which says The basicÂ XSS: https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=dGl0bGU9VGhlJTIwU1ZHJmluZ3JlZGllbnRzJTVCJTVEPUFuJTIwU1ZHJTIwdGFnJmluZ3JlZGllbnRzJTVCJTVEPVNvbWUlMjBqYXZhc2NyaXB0JmluZ3JlZGllbnRzJTVCJTVEPVNvbWUlMjBvbmxvYWQlMjBhY3Rpb24mcGF5bG9hZD0lM0NzdmclMjBvbmxvYWQlMjUzRGFsZXJ0KDEpJTNFJnN0ZXBzJTVCJTVEPUZpbmQlMjB0YXJnZXQmc3RlcHMlNUIlNUQ9SW5qZWN0JnN0ZXBzJTVCJTVEPUFMRVJUIQ== Upon opening the above urlÂ , you can notice that under Recipe, now itâ€™s not showing undefined likeÂ before. By decoding the base64 encoded string, we now know where these values cameÂ from. I modified the parameter values to a xss payload and then re encoded it to base64 to see if the xss payload works or not. It didnâ€™tÂ work From the js code (main.js), you can see that these parameter values are passed to innerText (which is a safe approachÂ here) https://medium.com/media/1b1fe0414450d49506ed8432d3de16bb/href As it was not possible to do anything from the recipe parameter, I started reading the js code to see where this username unknownUser281 cameÂ from. After reading the code I found that this username is taken from theÂ cookie: The code first reads the value for the cookie username parameter and then pass on line no 18 to the innerHTML https://medium.com/media/6dc2a8b0331669f82135df44054b9490/href At this point I thought if we can somehow take control over this cookie parameter we can easily get a xss as the value of the username cookie parameter is passed to innerHTML. We can verify the same by changing the cookie to a xss payload and here in this screenshot you can see that this actuallyÂ works: Itâ€™s a self xss for now, now we need to find a way to change it with some anotherÂ way. On line no 52Â , the decoded value of the recipe parameter is passed to the deparam function. jquery-deparam If you know already about the author of this challenge @WHOISbinit, you are aware that he has shared some great prototype pollution challenges in theÂ past. In one of his challenges he used the same vulnerable deparampackage.So it became very clear what I had to doÂ next. For more info regarding this you can read the belowÂ blogs: Snyk - Prototype Pollution in jquery-deparamclient-side-prototype-pollution/pp/jquery-deparam.md at master Â· BlackFan/client-side-prototype-pollution If you are new to prototype pollutionÂ , I recommend watching this twoÂ videos: https://medium.com/media/47f8a3fffdcd03d50611c40ff8ec8ddd/href https://medium.com/media/c6b15db0b1ac623c38b5375f49247992/href Now letâ€™s move on to prototype pollution, At first I started with a basic payload __proto__[test]=test If this payload works every object will have a new property name test with valueÂ test In this url, I have encoded the payload as if you remember the code from line 52Â , that the application first decodes the base64 string then it is used in the deparam function, so in order to make it work we have base64 encoded ourÂ payload. Cooking with Intigriti It workedÂ , the test property has been added successfully. Now we already know about the sink (innerHtml), have a working prototype pollution payload. The only missing thing is a script gadget which will allow us to make modification to the cookie parameterâ€™s value. Looking for a script gadgetâ€¦.. When it comes to prototype pollution, this repo is super useful. It contains the list of vulnerable packages with working payloads along with script gadgets in popular js files such as in our case itâ€™s Google analytics: GitHub - BlackFan/client-side-prototype-pollution: Prototype Pollution and useful Script Gadgets Along with importing the deparam js file, one more is imported Google Analytics The above mentioned repo also has a script gadget for the Google analytics.js client-side-prototype-pollution/google-analytics.md at master Â· BlackFan/client-side-prototype-pollution ?__proto__[cookieName]=COOKIE%3DInjection%3B Bingo exactly what we were looking for, this will allow us to change the usernamecookie parameter value to a xssÂ payload. Again first verifying it before adding the xssÂ payload: __proto__[cookieName]=username%3Dshirley%3B https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW2Nvb2tpZU5hbWVdPXVzZXJuYW1lJTNEc2hpcmxleSUzQg== As itâ€™s perfectly fine we will add the xss payloadÂ now: __proto__[cookieName]=username%3Dshirley%3Cimg%20src%3Dx%20onerror%3Dalert%28document.domain%29%3E%3B And here we goÂ , we successfully executed theÂ popup: https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW2Nvb2tpZU5hbWVdPXVzZXJuYW1lJTNEc2hpcmxleSUzQ2ltZyUyMHNyYyUzRHglMjBvbmVycm9yJTNEYWxlcnQlMjhkb2N1bWVudC5kb21haW4lMjklM0UlM0I= Thankyou for reading it till the lastÂ :) Sya Everyonee!" />
<link rel="canonical" href="http://localhost:4000/2021/08/23/solution-for-intigriti-s-august-xss-challenge.html" />
<meta property="og:url" content="http://localhost:4000/2021/08/23/solution-for-intigriti-s-august-xss-challenge.html" />
<meta property="og:site_name" content="Your awesome title" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-23T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Solution for Intigritiâ€™s August XSS challenge" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"GitHub User"},"dateModified":"2021-08-23T00:00:00+05:30","datePublished":"2021-08-23T00:00:00+05:30","description":"Heyyy Everyoneee, In this blog, I will be discussing the solution for the Intigritiâ€™s August XSS challenge. INTIGRITI on Twitter: &quot;â° It&#39;s CHALLENGE O&#39;CLOCK!ğŸ‘‰ Find the XSS before Sunday August 22nd, 23:59 CETğŸ‘‰ Win â‚¬300 in SWAG prizesğŸ‘‰ We&#39;ll release a tip on our Discord (Check replies for link) for every 100 likes on this tweet!Thanks @WHOISbinit for the challenge! ğŸ‘‡https://t.co/f631AbNmXf / Twitter&quot; â° It&#39;s CHALLENGE O&#39;CLOCK!ğŸ‘‰ Find the XSS before Sunday August 22nd, 23:59 CETğŸ‘‰ Win â‚¬300 in SWAG prizesğŸ‘‰ We&#39;ll release a tip on our Discord (Check replies for link) for every 100 likes on this tweet!Thanks @WHOISbinit for the challenge! ğŸ‘‡https://t.co/f631AbNmXf This will be a step by step walkthrough how I was able to find the xss vulnerability. Opening the challenge url, we can see that this endpoint https://challenge-0821.intigriti.io/challenge/cooking.html is loaded in the home page in anÂ iframe. Under collections you will find 3 urls which are having a base64 encoding string in the recipe parameter. Here is the url for the collection which says The basicÂ XSS: https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=dGl0bGU9VGhlJTIwU1ZHJmluZ3JlZGllbnRzJTVCJTVEPUFuJTIwU1ZHJTIwdGFnJmluZ3JlZGllbnRzJTVCJTVEPVNvbWUlMjBqYXZhc2NyaXB0JmluZ3JlZGllbnRzJTVCJTVEPVNvbWUlMjBvbmxvYWQlMjBhY3Rpb24mcGF5bG9hZD0lM0NzdmclMjBvbmxvYWQlMjUzRGFsZXJ0KDEpJTNFJnN0ZXBzJTVCJTVEPUZpbmQlMjB0YXJnZXQmc3RlcHMlNUIlNUQ9SW5qZWN0JnN0ZXBzJTVCJTVEPUFMRVJUIQ== Upon opening the above urlÂ , you can notice that under Recipe, now itâ€™s not showing undefined likeÂ before. By decoding the base64 encoded string, we now know where these values cameÂ from. I modified the parameter values to a xss payload and then re encoded it to base64 to see if the xss payload works or not. It didnâ€™tÂ work From the js code (main.js), you can see that these parameter values are passed to innerText (which is a safe approachÂ here) https://medium.com/media/1b1fe0414450d49506ed8432d3de16bb/href As it was not possible to do anything from the recipe parameter, I started reading the js code to see where this username unknownUser281 cameÂ from. After reading the code I found that this username is taken from theÂ cookie: The code first reads the value for the cookie username parameter and then pass on line no 18 to the innerHTML https://medium.com/media/6dc2a8b0331669f82135df44054b9490/href At this point I thought if we can somehow take control over this cookie parameter we can easily get a xss as the value of the username cookie parameter is passed to innerHTML. We can verify the same by changing the cookie to a xss payload and here in this screenshot you can see that this actuallyÂ works: Itâ€™s a self xss for now, now we need to find a way to change it with some anotherÂ way. On line no 52Â , the decoded value of the recipe parameter is passed to the deparam function. jquery-deparam If you know already about the author of this challenge @WHOISbinit, you are aware that he has shared some great prototype pollution challenges in theÂ past. In one of his challenges he used the same vulnerable deparampackage.So it became very clear what I had to doÂ next. For more info regarding this you can read the belowÂ blogs: Snyk - Prototype Pollution in jquery-deparamclient-side-prototype-pollution/pp/jquery-deparam.md at master Â· BlackFan/client-side-prototype-pollution If you are new to prototype pollutionÂ , I recommend watching this twoÂ videos: https://medium.com/media/47f8a3fffdcd03d50611c40ff8ec8ddd/href https://medium.com/media/c6b15db0b1ac623c38b5375f49247992/href Now letâ€™s move on to prototype pollution, At first I started with a basic payload __proto__[test]=test If this payload works every object will have a new property name test with valueÂ test In this url, I have encoded the payload as if you remember the code from line 52Â , that the application first decodes the base64 string then it is used in the deparam function, so in order to make it work we have base64 encoded ourÂ payload. Cooking with Intigriti It workedÂ , the test property has been added successfully. Now we already know about the sink (innerHtml), have a working prototype pollution payload. The only missing thing is a script gadget which will allow us to make modification to the cookie parameterâ€™s value. Looking for a script gadgetâ€¦.. When it comes to prototype pollution, this repo is super useful. It contains the list of vulnerable packages with working payloads along with script gadgets in popular js files such as in our case itâ€™s Google analytics: GitHub - BlackFan/client-side-prototype-pollution: Prototype Pollution and useful Script Gadgets Along with importing the deparam js file, one more is imported Google Analytics The above mentioned repo also has a script gadget for the Google analytics.js client-side-prototype-pollution/google-analytics.md at master Â· BlackFan/client-side-prototype-pollution ?__proto__[cookieName]=COOKIE%3DInjection%3B Bingo exactly what we were looking for, this will allow us to change the usernamecookie parameter value to a xssÂ payload. Again first verifying it before adding the xssÂ payload: __proto__[cookieName]=username%3Dshirley%3B https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW2Nvb2tpZU5hbWVdPXVzZXJuYW1lJTNEc2hpcmxleSUzQg== As itâ€™s perfectly fine we will add the xss payloadÂ now: __proto__[cookieName]=username%3Dshirley%3Cimg%20src%3Dx%20onerror%3Dalert%28document.domain%29%3E%3B And here we goÂ , we successfully executed theÂ popup: https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW2Nvb2tpZU5hbWVdPXVzZXJuYW1lJTNEc2hpcmxleSUzQ2ltZyUyMHNyYyUzRHglMjBvbmVycm9yJTNEYWxlcnQlMjhkb2N1bWVudC5kb21haW4lMjklM0UlM0I= Thankyou for reading it till the lastÂ :) Sya Everyonee!","headline":"Solution for Intigritiâ€™s August XSS challenge","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/08/23/solution-for-intigriti-s-august-xss-challenge.html"},"url":"http://localhost:4000/2021/08/23/solution-for-intigriti-s-august-xss-challenge.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Your awesome title" />
<script src="//cdn.jsdelivr.net/npm/@microlink/vanilla@latest/umd/microlink.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function (event) {
    microlink('.card-preview')
  })
</script>
  
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Your awesome title</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Solution for Intigritiâ€™s August XSS challenge</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-08-23T00:00:00+05:30" itemprop="datePublished">
        Aug 23, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Heyyy Everyoneee,</p><p>In this blog, I will be discussing the solution for the <strong>Intigritiâ€™s August XSS challenge.</strong></p><h3>INTIGRITI on Twitter: &quot;â° It&#39;s CHALLENGE O&#39;CLOCK!ğŸ‘‰ Find the XSS before Sunday August 22nd, 23:59 CETğŸ‘‰ Win â‚¬300 in SWAG prizesğŸ‘‰ We&#39;ll release a tip on our Discord (Check replies for link) for every 100 likes on this tweet!Thanks @WHOISbinit for the challenge! ğŸ‘‡https://t.co/f631AbNmXf / Twitter&quot;</h3><p>â° It&#39;s CHALLENGE O&#39;CLOCK!ğŸ‘‰ Find the XSS before Sunday August 22nd, 23:59 CETğŸ‘‰ Win â‚¬300 in SWAG prizesğŸ‘‰ We&#39;ll release a tip on our Discord (Check replies for link) for every 100 likes on this tweet!Thanks @WHOISbinit for the challenge! ğŸ‘‡https://t.co/f631AbNmXf</p><p>This will be a step by step walkthrough how I was able to find the xss vulnerability.</p><p>Opening the challenge url, we can see that this endpoint <a href="https://challenge-0821.intigriti.io/challenge/cooking.html">https://challenge-0821.intigriti.io/challenge/cooking.html</a> is loaded in the home page in anÂ <em>iframe</em>.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*J8ACMK79F5Bikj2VMe5TIQ.png" /></figure><p>Under <em>collections </em>you will find 3 urls which are having a base64 encoding string in the recipe parameter.</p><p>Here is the url for the <em>collection</em> which says <em>The basicÂ XSS:</em></p><p><a href="https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=dGl0bGU9VGhlJTIwU1ZHJmluZ3JlZGllbnRzJTVCJTVEPUFuJTIwU1ZHJTIwdGFnJmluZ3JlZGllbnRzJTVCJTVEPVNvbWUlMjBqYXZhc2NyaXB0JmluZ3JlZGllbnRzJTVCJTVEPVNvbWUlMjBvbmxvYWQlMjBhY3Rpb24mcGF5bG9hZD0lM0NzdmclMjBvbmxvYWQlMjUzRGFsZXJ0KDEpJTNFJnN0ZXBzJTVCJTVEPUZpbmQlMjB0YXJnZXQmc3RlcHMlNUIlNUQ9SW5qZWN0JnN0ZXBzJTVCJTVEPUFMRVJUIQ==">https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=dGl0bGU9VGhlJTIwU1ZHJmluZ3JlZGllbnRzJTVCJTVEPUFuJTIwU1ZHJTIwdGFnJmluZ3JlZGllbnRzJTVCJTVEPVNvbWUlMjBqYXZhc2NyaXB0JmluZ3JlZGllbnRzJTVCJTVEPVNvbWUlMjBvbmxvYWQlMjBhY3Rpb24mcGF5bG9hZD0lM0NzdmclMjBvbmxvYWQlMjUzRGFsZXJ0KDEpJTNFJnN0ZXBzJTVCJTVEPUZpbmQlMjB0YXJnZXQmc3RlcHMlNUIlNUQ9SW5qZWN0JnN0ZXBzJTVCJTVEPUFMRVJUIQ==</a></p><p>Upon opening the above urlÂ , you can notice that under <strong>Recipe</strong>, now itâ€™s not showing <em>undefined </em>likeÂ before.</p><p>By decoding the base64 encoded string, we now know where these values cameÂ from.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*_Gzp_NslDXB8mh2weM-3vg.png" /></figure><p>I modified the parameter values to a xss payload and then re encoded it to base64 to see if the xss payload works or not. It didnâ€™tÂ work</p><p>From the js code (main.js), you can see that these parameter values are passed to innerText (which is a safe approachÂ here)</p><iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/1b1fe0414450d49506ed8432d3de16bb/href">https://medium.com/media/1b1fe0414450d49506ed8432d3de16bb/href</a></iframe><p>As it was not possible to do anything from the recipe parameter, I started reading the js code to see where this username <strong>unknownUser281 </strong>cameÂ from.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/921/1*KASnNCIhB_ofzkHQnvYU4A.png" /></figure><p>After reading the code I found that this username is taken from theÂ cookie:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/738/1*Ae89YpUgc0gUB_F_SpSjRQ.png" /></figure><p>The code first reads the value for the cookie username parameter and then pass on line no 18 to the innerHTML</p><iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/6dc2a8b0331669f82135df44054b9490/href">https://medium.com/media/6dc2a8b0331669f82135df44054b9490/href</a></iframe><p>At this point I thought if we can somehow take control over this cookie parameter we can easily get a xss as the value of the username cookie parameter is passed to innerHTML.</p><p>We can verify the same by changing the cookie to a xss payload and here in this screenshot you can see that this actuallyÂ works:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*HQXMl2N35FL4SQIRXO85nQ.png" /></figure><p>Itâ€™s a <em>self xss</em> for now, now we need to find a way to change it with some anotherÂ way.</p><p>On line no 52Â , the decoded value of the recipe parameter is passed to the deparam function.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/894/1*OJBGdif3KfpocmhjadPUKw.png" /></figure><p><a href="https://www.npmjs.com/package/jquery-deparam">jquery-deparam</a></p><p>If you know already about the author of this challenge <a href="https://twitter.com/WHOISbinit">@WHOISbinit</a>, you are aware that he has shared some great prototype pollution challenges in theÂ past.</p><p>In one of his challenges he used the same vulnerable deparampackage.So it became very clear what I had to doÂ next.</p><p>For more info regarding this you can read the belowÂ blogs:</p><ul><li><a href="https://snyk.io/vuln/SNYK-JS-JQUERYDEPARAM-1255651">Snyk - Prototype Pollution in jquery-deparam</a></li><li><a href="https://github.com/BlackFan/client-side-prototype-pollution/blob/master/pp/jquery-deparam.md">client-side-prototype-pollution/pp/jquery-deparam.md at master Â· BlackFan/client-side-prototype-pollution</a></li></ul><p>If you are new to <em>prototype pollution</em>Â , I recommend watching this twoÂ videos:</p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FJ3MIOIqvV8w%3Ffeature%3Doembed&amp;display_name=YouTube&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DJ3MIOIqvV8w&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FJ3MIOIqvV8w%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" width="854" height="480" frameborder="0" scrolling="no"><a href="https://medium.com/media/47f8a3fffdcd03d50611c40ff8ec8ddd/href">https://medium.com/media/47f8a3fffdcd03d50611c40ff8ec8ddd/href</a></iframe><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FyDmOXhr8wmw%3Ffeature%3Doembed&amp;display_name=YouTube&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DyDmOXhr8wmw&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FyDmOXhr8wmw%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" width="854" height="480" frameborder="0" scrolling="no"><a href="https://medium.com/media/c6b15db0b1ac623c38b5375f49247992/href">https://medium.com/media/c6b15db0b1ac623c38b5375f49247992/href</a></iframe><h4>Now letâ€™s move on to prototype pollution,</h4><p>At first I started with a basic payload __proto__[test]=test</p><p>If this payload works every object will have a new property name test with valueÂ test</p><p>In this url, I have encoded the payload as if you remember the code from line 52Â , that the application first decodes the base64 string then it is used in the deparam function, so in order to make it work we have base64 encoded ourÂ payload.</p><p><a href="https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW3Rlc3RdPXRlc3Q=">Cooking with Intigriti</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*yHBzKx85iU0SUbo0m1GW_w.png" /></figure><p>It workedÂ , the test property has been added successfully.</p><p>Now we already know about the sink (innerHtml), have a working prototype pollution payload. The only missing thing is a script gadget which will allow us to make modification to the cookie parameterâ€™s value.</p><h4>Looking for a script gadgetâ€¦..</h4><p>When it comes to prototype pollution, this repo is super useful. It contains the list of vulnerable packages with working payloads along with script gadgets in popular js files such as in our case itâ€™s <em>Google analytics</em>:</p><p><a href="https://github.com/BlackFan/client-side-prototype-pollution">GitHub - BlackFan/client-side-prototype-pollution: Prototype Pollution and useful Script Gadgets</a></p><p>Along with importing the deparam js file, one more is imported <em>Google Analytics</em></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*WLqhHTZ1Y6DHiG0aN5NGPg.png" /></figure><p>The above mentioned repo also has a script gadget for the Google analytics.js</p><p><a href="https://github.com/BlackFan/client-side-prototype-pollution/blob/master/gadgets/google-analytics.md">client-side-prototype-pollution/google-analytics.md at master Â· BlackFan/client-side-prototype-pollution</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*L66h4r5_atO1VUkLO0aEvQ.png" /></figure><pre>?__proto__[cookieName]=COOKIE%3DInjection%3B</pre><p>Bingo exactly what we were looking for, this will allow us to change the usernamecookie parameter value to a xssÂ payload.</p><p>Again first verifying it before adding the xssÂ payload:</p><p>__proto__[cookieName]=username%3Dshirley%3B</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/547/1*aqU3RX0qKiXmV8VaIrB0iQ.png" /><figcaption><a href="https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW2Nvb2tpZU5hbWVdPXVzZXJuYW1lJTNEc2hpcmxleSUzQg==">https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW2Nvb2tpZU5hbWVdPXVzZXJuYW1lJTNEc2hpcmxleSUzQg==</a></figcaption></figure><p>As itâ€™s perfectly fine we will add the xss payloadÂ now:</p><p>__proto__[cookieName]=username%3Dshirley%3Cimg%20src%3Dx%20onerror%3Dalert%28document.domain%29%3E%3B</p><p>And here we goÂ , we successfully executed theÂ popup:</p><p><a href="https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW2Nvb2tpZU5hbWVdPXVzZXJuYW1lJTNEc2hpcmxleSUzQ2ltZyUyMHNyYyUzRHglMjBvbmVycm9yJTNEYWxlcnQlMjhkb2N1bWVudC5kb21haW4lMjklM0UlM0I=">https://challenge-0821.intigriti.io/challenge/cooking.html?recipe=X19wcm90b19fW2Nvb2tpZU5hbWVdPXVzZXJuYW1lJTNEc2hpcmxleSUzQ2ltZyUyMHNyYyUzRHglMjBvbmVycm9yJTNEYWxlcnQlMjhkb2N1bWVudC5kb21haW4lMjklM0UlM0I=</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Bn3cnNFsI5MxtI4FtcHTaA.png" /></figure><p>Thankyou for reading it till the lastÂ :)</p><p>Sya Everyonee!</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=5d548911e0fe" width="1" height="1" alt="">

  </div><a class="u-url" href="/2021/08/23/solution-for-intigriti-s-august-xss-challenge.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">GitHub User</li>
          <li><a class="u-email" href="mailto:your-email@domain.com">your-email@domain.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
